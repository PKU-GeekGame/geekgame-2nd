# 乱码还原

只解出来flag1，我是通过将乱码一个个替换回去，最终剩下几个还原不了的乱码暴力搜索的办法解决的。

乱码产生的原因是64行`shift_jis`编码方式处理不了部分字符，该部分字符就丢失了，强行解码后能够得到一句话：

```
佛曰��麼是梵殿皤盡皤�娑苦冥那盧羯伊罰智盡夜梵勝俱實利盧皤呼呐�帝夢梵��實呐等依皤��倒伊以亦�數怯姪尼怯無呐��神�夷��摩智呐伽恐�亦冥彌缽�
```

丢失这么多字符，搜索空间太大了，得想办法减少一些未知字符。

首先开头的两个��应该是冒号`：`。

然后将`TUDOU`和`BYTEMARK`中的字符通过`shift_jis`编码后输出，再对照密文，能够得到部分位置的�。
这一步之后，应该能得到完整的前半句话的原文，进行`Decrypt`能够得到`flag{...`开头的正确的前半部分，这就给解码增加了很大信心。

查看`Decrypt`,`Encrypt`函数发现，当字符包含在`BYTEMARK`中时，该字符是不包含信息而直接被略过的。这样能够进一步减少搜索空间。

一顿操作后，最终我只剩下3个�无法确定，搜索了一下就解出了flag。
