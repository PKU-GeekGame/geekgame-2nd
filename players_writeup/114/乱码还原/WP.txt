本题的加解密算法本身并不复杂，AES加密+字符查找表。难点源自编码方式。在加密后，密文被转换成了Shift-JIS编码。但这个过程是有损的，直接转回UTF-8得到的密文是无法被正确解密的。查看字符串原始数据，可以发现其中部分bytes已经在转为Shift-JIS的过程中丢失了。
我原先想写一个修复脚本，奈何不知道怎么实现，就只能用笨办法，枚举出所有损坏字符可能对应的原字符，生成所有可能的密文，然后解密。枚举的过程参见sol1.txt和sol1.py，最终解密得到的所有原文中只有一个是有意义的flag。当然，这个办法也仅限flag1可用，flag2就很难蛮干了。